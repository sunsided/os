rd_("lBits: 55..5600lBits: 53..540lBits: 47..4800lBits: 44..4500Ed<strong>S</strong> \xe2\x80\x93 System bit (must be <code>0</code> for interrupt/trap gates).CaReached PT (L1) with its index and current entry.CjCode segment selector at the time of INT 0x80 (usually \xe2\x80\xa6lBits: 54..550BdDebugging extensions (DE) supported.BcBit 3 \xe2\x80\x94 DE: Debugging Extensions.BcDebug Store (DS) feature supported.BnFramebuffer information, passed from UEFI GOP.Aox86-64 Page Directory (PD / L2)Akx86-64 Page Table (PT / L1)AjSelf-Snoop (SS) supported.BaStack segment selector (user SS).BjTable Indicator (bit 2): 0 = GDT, 1 = LDT.AoThermal Monitor (TM) supported.DiUEFI <code>PixelFormat::Bgr</code> \xe2\x80\x94 8:8:8 (or bitmask-equivalent), \xe2\x80\xa6BjArchitectural model of CR0 in 64-bit mode.ChCR3 \xe2\x80\x94 Page-Map Level-4 Base Register (IA-32e, PCID \xe2\x80\xa6BdCR4 \xe2\x80\x94 Control Register 4 (x86-64).CnDescriptor Privilege Level (lives <em>in the descriptor</em>).AgGlobal Descriptor TableBgThe complete GDT for the bootstrap CPU.BfThe global interrupt descriptor table.ChA 256-entry <strong>Interrupt Descriptor Table</strong>.CoHardware <strong>Interrupt Stack Table (IST)</strong> selector.AfLocal Descriptor TablehThe MSR.0DfIdentifies a <strong>Model-Specific Register (MSR)</strong> by its \xe2\x80\xa6FiL2 <strong>PDE</strong> \xe2\x80\x94 pointer to a <strong>Page Table</strong> (non-leaf; PS <strong>= 0</strong>).DiUEFI <code>PixelFormat::Rgb</code> \xe2\x80\x94 8:8:8 (or bitmask-equivalent), \xe2\x80\xa6BfMinimal kernel virtual memory manager.lBits: 52..5300CeAdvanced Vector Extensions (AVX) instructions are \xe2\x80\xa6B`CMPXCHG8B instruction supported.BgDirect Cache Access (DCA) is supported.CbBit 1 \xe2\x80\x94 DPE (AMD K6 only): Data Prefetch Enable.lBits: 45..4700CmSet <strong>DPL</strong> (Descriptor Privilege Level), 0..=3.Cl<strong>DPL</strong> \xe2\x80\x93 Descriptor Privilege Level (0..=3).AaELF file handlingCnEnhanced <code>SpeedStep</code> Technology (EST) is supported.CdFused Multiply-Add (FMA) instructions are supported.AnOn-chip FPU (x87 FPU) present.D`Global Descriptor Table (GDT) &amp; Task State Segment (TSS) \xe2\x80\xa6kGDT storageDcReturns <code>Some(&amp;T)</code> if the cell has been initialized.BaRead the entry at <code>i</code>.B`Read an entry at <code>i</code>.BbRead the entry at the given index.2BkHyper-Threading Technology (HTT) supported.B`Interrupt Descriptor Table (IDT)BeRead one byte from an I/O port (x86).CnSet the <strong>IST</strong> index (0 disables IST switching).Dh<strong>IST</strong> \xe2\x80\x93 Interrupt Stack Table index (0 disables IST \xe2\x80\xa6BnBit 4 \xe2\x80\x94 L2D (AMD K6 only): L2 Cache Disable.Admapped length, bytesBmBit 10 \xe2\x80\x94 LMA: Long Mode Active (read-only).B`Bit 8 \xe2\x80\x94 LME: Long Mode Enable.BkMachine Check Architecture (MCA) supported.BhMachine Check Exception (MCE) supported.BdBit 6 \xe2\x80\x94 MCE: Machine-Check Enable.AiMMX technology supported.BhModel-Specific Registers (MSR) utilitiesCaModel-Specific Registers (RDMSR/WRMSR) supported.AnModel-Specific Registers (MSR)fSafetyBkCreates a new default initialized bitfield.00011000DiCreate a <strong>code</strong> selector from a GDT index and desired RPL.DgCreate a <strong>data/stack</strong> selector from a GDT index and RPL.EgCreate a <strong>TSS</strong> selector for <code>ltr</code>. RPL is architecturally \xe2\x80\xa633ClBuild a 64-bit <em>Available TSS</em> descriptor (type 0x9).DkCreate a new, empty IDT with all gates marked <strong>not present</strong>.55DiCreate from a raw value, asserting it is &lt; <code>S::SIZE</code> in \xe2\x80\xa66666C`Creates a new <code>Msr</code> from a raw index.777777DcCreates a new <code>SpinMutex</code> containing <code>value</code>.DeCreates a new <code>TicketMutex</code> containing <code>value</code>.10CiDisables interrupts if they are currently enabled and \xe2\x80\xa6BlCreates a new unlocked <code>RawSpin</code>.BdCreates a new, unlocked ticket lock.CoCreates a new <code>SpinLock</code> containing the given value.BoCreates a new, empty <code>SyncOnceCell</code>.>>BfConstruct from a raw <code>u16</code>.??0?BoConstruct an index from a raw <code>u16</code>.BkCreates a new default initialized bitfield.20BbBit 11 \xe2\x80\x94 NXE: No-Execute Enable.BlPhysical Address Extensions (PAE) supported.BjBit 5 \xe2\x80\x94 PAE: Physical Address Extension.BePage Attribute Table (PAT) supported.BePending Break Enable (PBE) supported.CaBit 4 \xe2\x80\x94 PCD: Page-level Cache Disable for PML4.CeBit 8 \xe2\x80\x94 PCE: Performance-Monitoring Counter Enable.BcPage Global Enable (PGE) supported.BbBit 7 \xe2\x80\x94 PGE: Page Global Enable.BgBit 22 \xe2\x80\x94 PKE: Protection Keys Enable.BePage-Size Extensions (PSE) supported.BdBit 4 \xe2\x80\x94 PSE: Page Size Extensions.BhProcessor Serial Number (PSN) available.kBits: 0..640CaBit 1 \xe2\x80\x94 PVI: Protected-Mode Virtual Interrupts.CaBit 3 \xe2\x80\x94 PWT: Page-level Write-Through for PML4.BgAccess the raw selector (index/TI/RPL).BeReturns the underlying raw MSR index.BbThe underlying raw lock primitive.000AlReturn RIP saved by the CPU.BfRequested Privilege Level (bits 0..1).B`Requested Privilege Level (RPL).CjReturn RSP saved by the CPU (user stack pointer on entry).BfBit 0 \xe2\x80\x94 SCE: System Call Extensions.BhSYSENTER/SYSEXIT instructions supported.BbWrite the entry at <code>i</code>.BaWrite an entry at <code>i</code>.BcWrite the entry at the given index.2BjSafer Mode Extensions (SMX) are supported.BjStreaming SIMD Extensions (SSE) supported.BlBit 15 \xe2\x80\x94 TCE: Translation Cache Extension.BeThermal Monitor 2 (TM2) is supported.Ae16B-aligned RSP startBcTime Stamp Counter (TSC) ManagementCaTime-Stamp Counter (RDTSC) instruction available.BbBit 2 \xe2\x80\x94 TSD: Time Stamp Disable.CbMinimal 64-bit Task State Segment (TSS) for x86_64Bk64-bit Available TSS descriptor (low+high).Da64-bit TSS required in long mode (rsp0, <code>ISTx</code>, iopb).lBits: 40..4400Eb<strong>Type</strong> \xe2\x80\x93 0xE = <em>Interrupt gate</em>, 0xF = <em>Trap gate</em>.BmVirtual 8086 mode extensions (VME) supported.BlBit 0 \xe2\x80\x94 VME: Virtual-8086 Mode Extensions.CdMinimal Virtual Memory Manager (VMM) for the kernel.BoVirtual Machine Extensions (VMX) are supported.Cm<code>IA32_EFER</code> / EFER (MSR <code>0xC000_0080</code>).ChOperand format used by <code>lidt</code> (limit + base).BkHardware IST#1 \xe2\x86\x92 <code>TSS.IST[0]</code>.BkHardware IST#2 \xe2\x86\x92 <code>TSS.IST[1]</code>.BkHardware IST#3 \xe2\x86\x92 <code>TSS.IST[2]</code>.BkHardware IST#4 \xe2\x86\x92 <code>TSS.IST[3]</code>.BkHardware IST#5 \xe2\x86\x92 <code>TSS.IST[4]</code>.BkHardware IST#6 \xe2\x86\x92 <code>TSS.IST[5]</code>.BkHardware IST#7 \xe2\x86\x92 <code>TSS.IST[6]</code>.BnNo alternate stack (IDT <code>.ist(0)</code>).CkCPU privilege rings, represented as numerical privilege \xe2\x80\xa6BoACPI 1.0 Root System Description Pointer (RSDP)BbPage size in bytes (power of two).0CdThis allocation is for usermode programs. Allows \xe2\x80\xa6CcACPI 2.0 Extended System Description Pointer (XSDP)BaThermal Monitor and ACPI support.CiAdvanced Programmable Interrupt Controller (APIC) SupportBjOn-chip APIC hardware present and enabled.DfBase <strong>linear (virtual) address</strong> of the table in memory.AoFirst mapped byte (above guard)BnReturn the base as <code>MemoryAddress</code>.B`Raw 64-bit storage of the entry.0AhKerrnel Boot InformationAdThe protected value.000BnConditional Move (CMOV) instruction supported.CiCMPXCHG16B instruction (Compare-and-swap 16 bytes) is \xe2\x80\xa6DiRestore SMAP protection by executing <code>clac</code> when the guard \xe2\x80\xa6DgRestores interrupts (<code>sti</code>) only if they were previously \xe2\x80\xa61Ch16-bit floating-point conversion instructions (F16C) \xe2\x80\xa6AoReturns the argument unchanged.0000fSafety11111001111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111CmBuild an index from a canonical virtual address (extracts \xe2\x80\xa622222220222CjConstruct an index from a canonical virtual address by \xe2\x80\xa633313333333333333ChFXSAVE/FXRSTOR instructions for FPU/MMX state supported.BmIndicates whether the lock is currently held.0BcRe-export constants as info module.BcKernel Initialization and BootstrapBaCall this once during early init.0BaCalls <code>U::from(self)</code>.000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000BhI/O Privilege Level mask (bits 12\xe2\x80\x9313).AlI/O Privilege Level (2 bits)Da<strong>IST1</strong>: optional dedicated stack for an IDT entry.Do<strong>IST2</strong>: optional dedicated stack for an IDT entry (IST index \xe2\x80\xa6Do<strong>IST3</strong>: optional dedicated stack for an IDT entry (IST index \xe2\x80\xa6Do<strong>IST4</strong>: optional dedicated stack for an IDT entry (IST index \xe2\x80\xa6Do<strong>IST5</strong>: optional dedicated stack for an IDT entry (IST index \xe2\x80\xa6Do<strong>IST6</strong>: optional dedicated stack for an IDT entry (IST index \xe2\x80\xa6Do<strong>IST7</strong>: optional dedicated stack for an IDT entry (IST index \xe2\x80\xa6BnCombine with an offset to form a full address.DhDecode the entry into its semantic kind, or <code>None</code> if not \xe2\x80\xa60CjBit 12 \xe2\x80\x94 LA57: 57-bit linear addresses (5-level paging).DmLoad this IDT into the CPU\xe2\x80\x99s <strong>IDTR</strong> using <code>lidt</code>.fSafetyCkAcquires the lock and returns a guard that unlocks on drop.CgAcquires the lock, spinning until it becomes available.CjAcquires the lock, spinning in FIFO order until available.1AgMemory map information.BmMemory Type Range Registers (MTRR) supported.BaThe next available ticket number.0BmNull descriptor (must be present at index 0).BdWrite one byte to an I/O port (x86).DkThe page for size <code>S</code> that contains this address (lower bits \xe2\x80\xa6CaProcess-context identifiers (PCID) are supported.CbPerformance Debug Capability MSR (PDCM) available.Box86-64 Page Directory Pointer Table (PDPT / L3)Anx86-64 Page Map Level 4 (PML4)EgQuery CPUID.01H if supported; returns <code>None</code> if <code>ranges</code> says \xe2\x80\xa6CgQuery CPUID.15H if available; None if leaf unsupported.CeQuery CPUID.16H if available; None if the leaf is \xe2\x80\xa6jBits: 2..3CdRSDP/XSDP (Root/Extended System Description Pointer)BhRoot/Extended System Description PointerDi<strong>Ring-0 stack pointer (RSP0)</strong> used on privilege elevation.Dl<strong>Ring-1 stack pointer (RSP1)</strong> \xe2\x80\x94 rarely used in modern OSes.Dl<strong>Ring-2 stack pointer (RSP2)</strong> \xe2\x80\x94 rarely used in modern OSes.BiSilicon debug interface (SDBG) available.AoTemporary SMAP-disabling guard.CcBit 21 \xe2\x80\x94 SMAP: Supervisor Mode Access Prevention.CfBit 20 \xe2\x80\x94 SMEP: Supervisor Mode Execution Prevention.AlBit 14 \xe2\x80\x94 SMXE: SMX Enable.BmStreaming SIMD Extensions 2 (SSE2) supported.CgStreaming SIMD Extensions 3 (SSE3) instructions are \xe2\x80\xa6CiBit 12 \xe2\x80\x94 SVME: Secure Virtual Machine Enable (AMD SVM).BmBit 20 \xe2\x80\x94 UAIE: Upper Address Ignore Enable.CbBit 11 \xe2\x80\x94 UMIP: User-Mode Instruction Prevention.Cb0 = supervisor (CPL 0\xe2\x80\x932). 1 = user mode (CPL 3).Dm<strong>User/Supervisor</strong> (US): user-mode access if <code>true</code>.0mUser (bit 2).0BfUser (bit 2): user-mode access if set.1Dh<strong>User/Supervisor</strong> (bit 2): allow user-mode access if set.2Dl<strong>Typed read-only view</strong> chosen by the <strong>PS</strong> bit.0CgVirtual Memory Setup for Kernel loading (new typed API)BiBit 13 \xe2\x80\x94 VMXE: VMX Enable (Intel VT-x).ChInternal walker: resolves VA to the point it terminates.BhxTPR update control (xTPR) is supported.BbCreate a zero (non-present) entry.0ChCreate a zero (non-present) entry with all bits cleared.1BoJust return a made-up number to prove plumbing.AiNon-leaf PDE view (PS=0).AkNon-leaf PDPTE view (PS=0).ChA generic mutex that delegates locking to a raw lock \xe2\x80\xa60EhL2 <strong>PDE (2 MiB leaf)</strong> \xe2\x80\x94 maps a single 2 MiB page (<code>PS = 1</code>).G`L3 <strong>PDPTE</strong> \xe2\x80\x94 pointer to a <strong>Page Directory</strong> (non-leaf; PS <strong>= 0</strong>\xe2\x80\xa6D`<strong>Ring 0 (DPL = 0)</strong> \xe2\x80\x94 Kernel or supervisor mode.Dk<strong>Ring 1 (DPL = 1)</strong> \xe2\x80\x94 Historically for OS components or \xe2\x80\xa6Dk<strong>Ring 2 (DPL = 2)</strong> \xe2\x80\x94 Historically for OS subsystems or \xe2\x80\xa6Cm<strong>Ring 3 (DPL = 3)</strong> \xe2\x80\x94 User-mode applications.Cilog2(SIZE), i.e., number of low bits used for the offset.0BlWhich descriptor table a selector addresses.Cj64-bit Task State Segment (TSS) as used by x86-64 long \xe2\x80\xa6BbAES-NI instructions are supported.AhKernel Memory ManagementBlThe allocator; hands out pages to work with.AnCLFLUSH instruction supported.AkCPUID Instruction InterfaceBnExecute CPUID with the given leaf and subleaf.Cf<strong>Dirty</strong> (D): set by CPU on first write.0Dk<strong>Dirty</strong> (bit 6): set by CPU on first write to this 2 MiB \xe2\x80\xa6Dk<strong>Dirty</strong> (bit 6): set by CPU on first write to this 1 GiB \xe2\x80\xa6BiDirty (bit 6): set by CPU on first write.BgEnter a temporary SMAP-disabled region.BlNon-leaf form: next-level Page Table (PS=0).C`Non-leaf form: next-level Page Directory (PS=0).BfBit 14 \xe2\x80\x94 FFXSR: Fast FXSAVE/FXRSTOR.CoELF <code>p_flags</code> (<code>PF_X</code>, <code>PF_W</code>)AnDescriptor index (bits 3..15).AdThe protected value.0CjBit 18 \xe2\x80\x94 INTWB: Interruptible WBINVD/WBNOINVD enable \xe2\x80\xa6BdKernel code segment (64-bit, DPL=0).CnKernel data/stack segment (DPL=0). Must be one index after \xe2\x80\xa6CfSize of the table <strong>minus one</strong> in bytes.CaBit 13 \xe2\x80\x94 LMSLE: Long Mode Segment Limit Enable.AfBase model (bits 7:4).CeMOVBE instruction (move with byte swap) is supported.BiThe ticket number currently being served.0AdKernel Panic HandlerCaValidate the RSDP/XSDP from the physical address.BnBit 17 \xe2\x80\x94 PCIDE: Process-Context Identifiers.Acx86 I/O Port AccessBn36-bit Page Size Extension (PSE-36) supported.CmTranslate VA\xe2\x86\x92PA if mapped (handles 1G/2M/4K leaves with \xe2\x80\xa6EbTranslate a <code>VirtualAddress</code> to <code>PhysicalAddress</code> if mapped.lBits: 55..5600lBits: 53..540lBits: 47..4800lBits: 44..4500Ed<strong>S</strong> \xe2\x80\x93 System bit (must be <code>0</code> for interrupt/trap gates).EiSplit into (<code>MemoryPage&lt;S&gt;</code>, <code>MemoryAddressOffset&lt;S&gt;</code>).CeSupplemental SSE3 (SSSE3) instructions are supported.fSafetyBbAccounting / stats you might grow.BbUser code segment (64-bit, DPL=3).CmUser data/stack segment (DPL=3). Must be one index before \xe2\x80\xa6Bf0 = read or execute. 1 = write access.jBits: 1..2ChXSAVE/XRSTOR processor state management instructions \xe2\x80\xa6<lBits: 54..55EcA single 8-byte GDT entry with <strong>code</strong> or <strong>data</strong> view.CgThis allocation is for kernelspace programs. Allows \xe2\x80\xa6Bn<strong>Borrowed view</strong> into an L2 PDE.C`<strong>Borrowed view</strong> into an L3 PDPTE.CiCPUID.16H \xe2\x80\x94 Processor Frequency Information (Intel, \xe2\x80\xa6AiHit a 1 GiB leaf at PDPT.Am1 GiB leaf PDPTE view (PS=1).AgHit a 2 MiB leaf at PD.Ak2 MiB leaf PDE view (PS=1).CmBitfield wrapper for <code>Elf64_Phdr.p_flags</code> (32-bit)DnHardware <strong>Page Size</strong> (PS) bit position shared across levels \xe2\x80\xa6BfArchitectural RFLAGS model for x86-64.Bn1 GiB page (<code>1_073_741_824</code> bytes).0Bj2 MiB page (<code>2_097_152</code> bytes).0Ah4 KiB page (4096 bytes).0CcTSS system segment selector (for <code>ltr</code>).Bb0 = UNINIT, 1 = INITING, 2 = READYBiBit 21 \xe2\x80\x94 AIBRSE: Automatic IBRS Enable.CdBus/reference frequency in Hz (if ECX was non-zero).CjLogical CPU index (0..n-1). Often equals BSP/AP numbering.BlCPL-qualified debug store area is supported.Bl64-bit DS area for debug store is supported.EbEncode as <code>u16</code> (for <code>iret</code>, <code>mov ss, ax</code>, etc.).AhBase family (bits 11:8).CeBit 3 \xe2\x80\x94 GEWBED (AMD K6 only): Global EWBE# Disable.Dg<strong>Global</strong> (G): TLB not flushed on CR3 reload (leaf only).0De<strong>Global</strong> (bit 8): TLB entry not flushed on CR3 reload.0CdGlobal (bit 8): TLB entry not flushed on CR3 reload.ChInvalidate one VA on this CPU (when you modified the \xe2\x80\xa6Aix86-64 Higher-Half KernelAbELF Segment LoaderkLock state:0fSafetyBnMaximum frequency in Hz (if EBX was non-zero).mMemory LayoutDhThe offset within the page of size <code>S</code> that contains this \xe2\x80\xa6BmBit 9 \xe2\x80\x94 OSFXSR: OS supports FXSAVE/FXRSTOR.AbELF Header ParsingDgBorrow a <code>PageDirectory</code> (PD) located in the given 4 KiB \xe2\x80\xa6CfBorrow a <code>PageDirectory</code> (PD) in this frameB`POPCNT instruction is supported.DcBorrow a <code>PageTable</code> (PT) located in the given 4 KiB \xe2\x80\xa6CcBorrow a <code>PageTable</code> (PT) in this frame.ClRDRAND instruction (hardware random number generator) is \xe2\x80\xa6ChRFLAGS at the time of INT 0x80 (IF is cleared on entry).DlReturns the current <code>RFLAGS</code> value (via <code>pushfq/pop</code>).DgSealed trait pattern to restrict <code>PageSize</code> impls to our \xe2\x80\xa6lBits: 54..550BdDebugging extensions (DE) supported.BcBit 3 \xe2\x80\x94 DE: Debugging Extensions.BcDebug Store (DS) feature supported.E`Sets the provided <code>PageDirectory</code> at the specified <code>page</code>.DlSets the provided <code>PageTable</code> at the specified <code>page</code>.AjSelf-Snoop (SS) supported.BjTable Indicator (bit 2): 0 = GDT, 1 = LDT.AoThermal Monitor (TM) supported.CjBit 2 \xe2\x80\x94 SEWBED (AMD K6 only): Speculative EWBE# Disable.CkStreaming SIMD Extensions 4.1 (SSE4.1) instructions are \xe2\x80\xa6CkStreaming SIMD Extensions 4.2 (SSE4.2) instructions are \xe2\x80\xa6BhEncode into <code>Pde</code> (non-leaf).C`Return the selector as a plain <code>u16</code>.CfRaw 64-bit encoding (safe to read for either variant).C`Compute TSC frequency if enough info is present.AbReleases the lock.ChReleases the lock and advances ownership to the next \xe2\x80\xa6lBits: 55..5600lBits: 53..540lBits: 47..4800lBits: 44..4500Ed<strong>S</strong> \xe2\x80\x93 System bit (must be <code>0</code> for interrupt/trap gates).Cgx2APIC mode is supported (Extended APIC ID register \xe2\x80\xa6CeCreate a fully zeroed Page Directory (all entries \xe2\x80\xa6CeCreate a fully zeroed PDPT (all entries non-present).CkCreate a fully zeroed (all entries non-present) PML4 table.CkCreate a fully zeroed Page Table (all entries non-present).DeUEFI <code>PixelFormat::Bitmask(mask)</code> \xe2\x80\x94 see the masks in \xe2\x80\xa6EeUEFI <code>PixelFormat::BltOnly</code> \xe2\x80\x94 <strong>no linear framebuffer </strong>\xe2\x80\xa6AkCode segment (CS) selector.AoData/stack (DS/ES/SS) selector.CcYou will write a <strong>PTE</strong> (4 KiB leaf).DfIndex into the Page Table (derived from VA bits <code>[20:12]</code>).CcYou will write a <strong>PDE</strong> (2 MiB leaf).DkIndex into the Page Directory (derived from VA bits <code>[29:21]</code>\xe2\x80\xa6CeYou will write a <strong>PDPTE</strong> (1 GiB leaf).CjIndex into the PDPT (derived from virtual-address bits \xe2\x80\xa6CkIndex into the PML4 table (derived from virtual-address \xe2\x80\xa6ChCPUID.01H \xe2\x80\x94 Feature Information (a.k.a. \xe2\x80\x9cleaf 1\xe2\x80\x9d).AlA zeroed, non-present entry.BePage-size\xe2\x80\x93directed mapping behavior0AoMissing somewhere in the chain.Fg<strong>L2 PDE union</strong> \xe2\x80\x94 overlays non-leaf <code>Pde</code> and leaf <code>Pde2M</code> on \xe2\x80\xa6EkL3 <strong>PDPTE (1 GiB leaf)</strong> \xe2\x80\x94 maps a single 1 GiB page (<code>PS = 1</code>\xe2\x80\xa6CfA low-level lock interface used by <code>Mutex</code>.CiA simple spinlock implementation based on an atomic flag.0BjAPIC/LAPIC id if you add AP startup later.DoView as code bits. <strong>Unsafe</strong>: UB if this entry isn\xe2\x80\x99t a code \xe2\x80\xa6DoView as data bits. <strong>Unsafe</strong>: UB if this entry isn\xe2\x80\x99t a data \xe2\x80\xa6lBits: 56..6400CcNominal/base frequency in Hz (if EAX was non-zero).lBits: 16..3200CdBus/reference clock in MHz (ECX). 0 means \xe2\x80\x9cnot \xe2\x80\xa6BjContext ID (CNXT-ID) feature is supported.EaGet the <code>PerCpu</code> reference from the current <code>IA32_GS_BASE</code>.0jBits: 0..1AmFrees a 4 KiB physical frame.CiDeallocate a zeroed 4 KiB page suitable for a page-table.BiFetch the Graphics Output Protocol (GOP).BoReturns a mutable reference to the inner value.0CnBorrow a mutable reference to the <strong>global IDT</strong>.BgReturns true if the frame is allocated.B`Leaf form: 1 GiB mapping (PS=1).B`Leaf form: 2 MiB mapping (PS=1).Chbytes to map from <code>vaddr_page</code> (page-rounded)FgMap <strong>one</strong> page of size <code>S</code> with <code>leaf_flags</code>, creating parents \xe2\x80\xa6FmMap <strong>one</strong> page at <code>va \xe2\x86\x92 pa</code> with size <code>S</code> and <code>leaf_flags</code>.CkMaximum frequency in MHz (EBX). 0 means \xe2\x80\x9cnot reported\xe2\x80\x9d.CeBit 17 \xe2\x80\x94 MCOMMIT: MCOMMIT instruction enable (AMD).BiMONITOR/MWAIT instructions are supported.BlOS has enabled XSAVE/XRSTOR via CR4.OSXSAVE.CbBit 18 \xe2\x80\x94 OSXSAVE: OS uses XSAVE/XRSTOR and XCR0.CmIf present, return the mapped 4 KiB physical page and its \xe2\x80\xa6BfPer-CPU Data Structures and ManagementEbSet the <strong>Present</strong> bit. Must be <code>true</code> for a usable gate.Dm<strong>P</strong> \xe2\x80\x93 Present bit. Must be <code>1</code> for a valid entry.Ch0 = non-present page. 1 = protection violation (page \xe2\x80\xa6Co<strong>Present</strong> (P): valid entry if <code>true</code>.0A`Present (bit 0).0BdPresent (bit 0): valid entry if set.1Ce<strong>Present</strong> (bit 0): valid entry if set.2A`The page tables.CmQuick per-CPU scratch / small allocator caches if you add \xe2\x80\xa6lBits: 52..5300CeAdvanced Vector Extensions (AVX) instructions are \xe2\x80\xa6B`CMPXCHG8B instruction supported.BgDirect Cache Access (DCA) is supported.CbBit 1 \xe2\x80\x94 DPE (AMD K6 only): Data Prefetch Enable.lBits: 45..4700Cl<strong>DPL</strong> \xe2\x80\x93 Descriptor Privilege Level (0..=3).CnEnhanced <code>SpeedStep</code> Technology (EST) is supported.CdFused Multiply-Add (FMA) instructions are supported.AnOn-chip FPU (x87 FPU) present.BkHyper-Threading Technology (HTT) supported.Dh<strong>IST</strong> \xe2\x80\x93 Interrupt Stack Table index (0 disables IST \xe2\x80\xa6BnBit 4 \xe2\x80\x94 L2D (AMD K6 only): L2 Cache Disable.BmBit 10 \xe2\x80\x94 LMA: Long Mode Active (read-only).B`Bit 8 \xe2\x80\x94 LME: Long Mode Enable.BkMachine Check Architecture (MCA) supported.BhMachine Check Exception (MCE) supported.BdBit 6 \xe2\x80\x94 MCE: Machine-Check Enable.AiMMX technology supported.CaModel-Specific Registers (RDMSR/WRMSR) supported.BbBit 11 \xe2\x80\x94 NXE: No-Execute Enable.BlPhysical Address Extensions (PAE) supported.BjBit 5 \xe2\x80\x94 PAE: Physical Address Extension.BePage Attribute Table (PAT) supported.BePending Break Enable (PBE) supported.CaBit 4 \xe2\x80\x94 PCD: Page-level Cache Disable for PML4.CeBit 8 \xe2\x80\x94 PCE: Performance-Monitoring Counter Enable.BcPage Global Enable (PGE) supported.BbBit 7 \xe2\x80\x94 PGE: Page Global Enable.BgBit 22 \xe2\x80\x94 PKE: Protection Keys Enable.BePage-Size Extensions (PSE) supported.BdBit 4 \xe2\x80\x94 PSE: Page Size Extensions.BhProcessor Serial Number (PSN) available.kBits: 0..640CaBit 1 \xe2\x80\x94 PVI: Protected-Mode Virtual Interrupts.CaBit 3 \xe2\x80\x94 PWT: Page-level Write-Through for PML4.BfRequested Privilege Level (bits 0..1).BfBit 0 \xe2\x80\x94 SCE: System Call Extensions.BhSYSENTER/SYSEXIT instructions supported.BjSafer Mode Extensions (SMX) are supported.BjStreaming SIMD Extensions (SSE) supported.BlBit 15 \xe2\x80\x94 TCE: Translation Cache Extension.BeThermal Monitor 2 (TM2) is supported.CaTime-Stamp Counter (RDTSC) instruction available.BbBit 2 \xe2\x80\x94 TSD: Time Stamp Disable.lBits: 40..4400Eb<strong>Type</strong> \xe2\x80\x93 0xE = <em>Interrupt gate</em>, 0xF = <em>Trap gate</em>.BmVirtual 8086 mode extensions (VME) supported.BlBit 0 \xe2\x80\x94 VME: Virtual-8086 Mode Extensions.BoVirtual Machine Extensions (VMX) are supported.AgSign Flag mask (bit 7).iSign FlagCex86_64 INT 0x80 syscall entry and minimal dispatcher.AgTrap Flag mask (bit 8).iTrap FlagBdConvert back to a <code>Ring</code>.AfKernel Tracing helperslTrace outputlBits: 54..550BdDebugging extensions (DE) supported.BcBit 3 \xe2\x80\x94 DE: Debugging Extensions.BcDebug Store (DS) feature supported.AjSelf-Snoop (SS) supported.BjTable Indicator (bit 2): 0 = GDT, 1 = LDT.AoThermal Monitor (TM) supported.E`Sets the provided <code>PageDirectory</code> at the specified <code>page</code>.ChZeroes the <code>PageDirectory</code> (PD) in this frameDlSets the provided <code>PageTable</code> at the specified <code>page</code>.CdZeroes the <code>PageTable</code> (PD) in this frameAgZero Flag mask (bit 6).iZero FlagBbResult of creating a kernel stack.BaGate kinds supported by this IDT.CgVirtual base for all IST stacks (choose a disjoint, \xe2\x80\xa6Dn<code>IA32_STAR</code> \xe2\x80\x94 System Call Target &amp; Segment Selectors (MSR \xe2\x80\xa60ChOne <strong>16-byte</strong> x86-64 IDT gate descriptor.CgRAII guard that disables interrupts on creation and \xe2\x80\xa6CgA mutex guard that also disables interrupts while held.BfCPUID.01H:EAX \xe2\x80\x94 Version Information.CfCPUID.01H:EBX \xe2\x80\x94 Brand/CLFLUSH/Logical Count/APIC ID.CiFeature flags returned by <code>CPUID.(EAX=1):ECX</code>.CiFeature flags returned by <code>CPUID.(EAX=1):EDX</code>.CiMSR index for <code>IA32_EFER</code> / <code>EFER</code>.BlPer-CPU configuration (GDT, IST, stack, \xe2\x80\xa6)BfMarker trait for supported page sizes.0AnRPL mask in a 16-bit selector.CdThe PML4 root page for an <code>AddressSpace</code>.CmA simple spinlock providing mutual exclusion for a single \xe2\x80\xa60DfLeaves <code>IF</code> unchanged; useful for debugging/tracing faults.Do<strong>Accessed</strong> (A): set by CPU on first access. Not a permission \xe2\x80\xa60AaAccessed (bit 5).000Dm<strong>Accessed</strong> (A, bit 5): set by CPU on first access via this \xe2\x80\xa61BjLoad CR3 with this address space\xe2\x80\x99s root.BhAllocates a single 4 KiB physical frame.CgAllocate a zeroed 4 KiB page suitable for a page-table.ChReturn the index as <code>usize</code> for table access.0CjReturn the index as <code>usize</code> for array indexing.1CgNominal/base frequency in MHz (EAX). 0 means \xe2\x80\x9cnot \xe2\x80\xa6lBits: 32..4000AhCarry Flag mask (bit 0).jCarry FlagAlProcessor type (bits 13:12).CmSet <strong>DPL</strong> (Descriptor Privilege Level), 0..=3.C`Populate from an L2 <code>Pde</code> (non-leaf).DeConstructs a <code>Mutex</code> from a raw lock and an initial value.CmBit 16 \xe2\x80\x94 FSGSBASE: Enable {R,W}{D,}FSBASE/GSBASE in CPL \xe2\x80\xa6AfID Flag mask (bit 21).AoID Flag: allows toggling CPUID.BkDerive the PD index from a virtual address.BmDerive the PDPT index from a virtual address.CgDerive the <code>L4Index</code> from a virtual address.BkDerive the PT index from a virtual address.ChInitialize the TSS with a kernel RSP0 and optional IST1.DaTwo bytes packed via <code>IdtGateAttr</code> (IST + type/attrs).lBits: 48..5200kBits: 0..1600BbLoad a GDT with <code>lgdt</code>.DiReads the 64-bit value from the given <strong>Model-Specific </strong>\xe2\x80\xa6CgAcquires the mutex with interrupts disabled for the \xe2\x80\xa6AnMemory Page Table Mapping SizeCjLength of the memory map buffer in <strong>bytes</strong>.CgPointer to the raw UEFI memory map buffer (array of \xe2\x80\xa6BkCreate a raw selector (no semantic checks).BePAT selector <strong>bit #2</strong>:0DiBorrow a <code>PageDirectoryPointerTable</code> (PDPT) located in the \xe2\x80\xa6DdBorrow a <code>PageDirectoryPointerTable</code> (PDPT) in this frameDkBorrow the <code>PageMapLevel4</code> (PML4) located in the given 4 KiB \xe2\x80\xa6CnBorrow the <code>PageMapLevel4</code> (PML4) as a typed table.CnAcquires the lock (may spin or block) and returns when the \xe2\x80\xa6DoGet the <code>PerCpu</code> pointer from the current <code>IA32_GS_BASE</code>.EhGet the <code>PerCpu</code> pointer from the current <code>IA32_KERNEL_GS_BASE</code>\xe2\x80\xa6CjMask of the red channel within a pixel (e.g., 0x00ff0000).lBits: 32..64DhOverride the code segment <strong>selector</strong> (defaults to the \xe2\x80\xa6BaThermal Monitor and ACPI support.BjOn-chip APIC hardware present and enabled.BnConditional Move (CMOV) instruction supported.CiCMPXCHG16B instruction (Compare-and-swap 16 bytes) is \xe2\x80\xa6Ch16-bit floating-point conversion instructions (F16C) \xe2\x80\xa6ChFXSAVE/FXRSTOR instructions for FPU/MMX state supported.BhI/O Privilege Level mask (bits 12\xe2\x80\x9313).AlI/O Privilege Level (2 bits)CjBit 12 \xe2\x80\x94 LA57: 57-bit linear addresses (5-level paging).FhInstall the <strong>leaf</strong> entry for <code>va \xe2\x86\x92 pa</code> in the <code>leaf_tbl_page</code> \xe2\x80\xa60BmMemory Type Range Registers (MTRR) supported.CaProcess-context identifiers (PCID) are supported.CbPerformance Debug Capability MSR (PDCM) available.DcSets the provided <code>PageDirectoryPointerTable</code> at the \xe2\x80\xa6E`Sets the provided <code>PageMapLevel4</code> at the specified <code>page</code>.jBits: 2..3CiUpdate the Ring-0 stack pointer used on user\xe2\x86\x92kernel \xe2\x80\xa6BiSilicon debug interface (SDBG) available.CcBit 21 \xe2\x80\x94 SMAP: Supervisor Mode Access Prevention.CfBit 20 \xe2\x80\x94 SMEP: Supervisor Mode Execution Prevention.AlBit 14 \xe2\x80\x94 SMXE: SMX Enable.BmStreaming SIMD Extensions 2 (SSE2) supported.CgStreaming SIMD Extensions 3 (SSE3) instructions are \xe2\x80\xa6CiBit 12 \xe2\x80\x94 SVME: Secure Virtual Machine Enable (AMD SVM).BmBit 20 \xe2\x80\x94 UAIE: Upper Address Ignore Enable.CbBit 11 \xe2\x80\x94 UMIP: User-Mode Instruction Prevention.Cb0 = supervisor (CPL 0\xe2\x80\x932). 1 = user mode (CPL 3).mUser (bit 2).0BfUser (bit 2): user-mode access if set.1Dh<strong>User/Supervisor</strong> (bit 2): allow user-mode access if set.2BiBit 13 \xe2\x80\x94 VMXE: VMX Enable (Intel VT-x).BhxTPR update control (xTPR) is supported.CnSet the entry at <code>i</code> to <code>PdEntry::zero</code>.D`Set the entry at <code>i</code> to <code>PdptEntry::zero</code>.D`Set the entry at <code>i</code> to <code>PtEntry4k::zero</code>.AgStepping ID (bits 3:0).BjEncode into <code>Pdpte</code> (non-leaf).BnEncode into <code>Pml4Entry</code> (non-leaf).BnAttempts to acquire the lock without blocking.000lBits: 52..5300CeAdvanced Vector Extensions (AVX) instructions are \xe2\x80\xa6B`CMPXCHG8B instruction supported.BgDirect Cache Access (DCA) is supported.CbBit 1 \xe2\x80\x94 DPE (AMD K6 only): Data Prefetch Enable.lBits: 45..4700Cl<strong>DPL</strong> \xe2\x80\x93 Descriptor Privilege Level (0..=3).CnEnhanced <code>SpeedStep</code> Technology (EST) is supported.CdFused Multiply-Add (FMA) instructions are supported.AnOn-chip FPU (x87 FPU) present.BkHyper-Threading Technology (HTT) supported.Dh<strong>IST</strong> \xe2\x80\x93 Interrupt Stack Table index (0 disables IST \xe2\x80\xa6BnBit 4 \xe2\x80\x94 L2D (AMD K6 only): L2 Cache Disable.BmBit 10 \xe2\x80\x94 LMA: Long Mode Active (read-only).B`Bit 8 \xe2\x80\x94 LME: Long Mode Enable.BkMachine Check Architecture (MCA) supported.BhMachine Check Exception (MCE) supported.BdBit 6 \xe2\x80\x94 MCE: Machine-Check Enable.AiMMX technology supported.CaModel-Specific Registers (RDMSR/WRMSR) supported.BbBit 11 \xe2\x80\x94 NXE: No-Execute Enable.BlPhysical Address Extensions (PAE) supported.BjBit 5 \xe2\x80\x94 PAE: Physical Address Extension.BePage Attribute Table (PAT) supported.BePending Break Enable (PBE) supported.CaBit 4 \xe2\x80\x94 PCD: Page-level Cache Disable for PML4.CeBit 8 \xe2\x80\x94 PCE: Performance-Monitoring Counter Enable.BcPage Global Enable (PGE) supported.BbBit 7 \xe2\x80\x94 PGE: Page Global Enable.BgBit 22 \xe2\x80\x94 PKE: Protection Keys Enable.BePage-Size Extensions (PSE) supported.BdBit 4 \xe2\x80\x94 PSE: Page Size Extensions.BhProcessor Serial Number (PSN) available.kBits: 0..640CaBit 1 \xe2\x80\x94 PVI: Protected-Mode Virtual Interrupts.CaBit 3 \xe2\x80\x94 PWT: Page-level Write-Through for PML4.BfRequested Privilege Level (bits 0..1).BfBit 0 \xe2\x80\x94 SCE: System Call Extensions.BhSYSENTER/SYSEXIT instructions supported.BjSafer Mode Extensions (SMX) are supported.BjStreaming SIMD Extensions (SSE) supported.BlBit 15 \xe2\x80\x94 TCE: Translation Cache Extension.BeThermal Monitor 2 (TM2) is supported.CaTime-Stamp Counter (RDTSC) instruction available.BbBit 2 \xe2\x80\x94 TSD: Time Stamp Disable.lBits: 40..4400Eb<strong>Type</strong> \xe2\x80\x93 0xE = <em>Interrupt gate</em>, 0xF = <em>Trap gate</em>.BmVirtual 8086 mode extensions (VME) supported.BlBit 0 \xe2\x80\x94 VME: Virtual-8086 Mode Extensions.BoVirtual Machine Extensions (VMX) are supported.Dc<strong>Writable</strong> (RW): allows writes if <code>true</code>.0AaWritable (bit 1).0BcWritable (bit 1): write permission.1Cd<strong>Writable</strong> (bit 1): write permission.2DcA byte buffer with a <strong>guaranteed 16-byte alignment</strong>.CmA simple Higher Half Direct Map (HHDM) base. Anything you \xe2\x80\xa60BeMSR index for <code>IA32_STAR</code>.Bf16 KiB is enough for #PF/#DF handlers.Ba4 KiB guard below each IST stack.Fm<code>IA32_FMASK</code> \xe2\x80\x94 <code>RFLAGS</code> Mask for <code>syscall</code> (MSR <code>0xC000_0084</code>).0Ee<code>IA32_LSTAR</code> \xe2\x80\x94 64-bit SYSCALL Target RIP (MSR <code>0xC000_0082</code>).0DfWhere you place the bytes in <em>physical</em> memory (LMA) before \xe2\x80\xa60C`The Page Table (L1): 512 entries, 4 KiB-aligned.Ff<strong>L3 PDPTE union</strong> \xe2\x80\x94 overlays non-leaf <code>Pdpte</code> and leaf <code>Pdpte1G</code>DdMap a physical region and return a <em>read-only</em> byte slice \xe2\x80\xa6FkL4 <strong>PML4E</strong> \xe2\x80\x94 pointer to a <strong>PDPT</strong> (non-leaf; PS <strong>must be 0</strong>).DoL1 <strong>PTE (4 KiB leaf)</strong> \xe2\x80\x94 maps a single 4 KiB page (bit 7 is \xe2\x80\xa6CkA simple <em>ticket lock</em> implementation using atomics.0BkA companion trait that releases a raw lock.CfRAII guard that temporarily disables SMAP to allow \xe2\x80\xa6CkA <code>Mutex</code> backed by a <code>RawSpin</code> lock.CiSaved register/interrupt context for an INT 0x80 syscall.Cf16-byte TSS system descriptor (two consecutive GDT \xe2\x80\xa6AiAdjust Flag mask (bit 4).kAdjust FlagCkMask of the blue channel within a pixel (e.g., 0x000000ff).CnAllows the CPU to save some power. Functionally equivalent \xe2\x80\xa6AlExtended model (bits 19:16).BnConstruct from a full address\xe2\x80\x99s offset bits.CfCreate from a raw value, aligning down to the page \xe2\x80\xa6AbConvert from bits.0000000000AmDecode from the low two bits.1111111111CkConstruct union from raw <code>bits</code> (no validation).22022222BiConstruct from a <code>Ring</code> value.CkIf you already know the root frame (e.g., from your own \xe2\x80\xa6DdMake this a <strong>Trap Gate</strong> (type 0xF, <code>S=0</code>).BaChoose the gate type via an enum.AbConvert into bits.0000000000BiEncode as the low two bits of a selector.1111111111CbExtract raw <code>bits</code> back from the union.22022222CmCheck whether this IDT is currently loaded in the CPU\xe2\x80\x99s \xe2\x80\xa6BfLoads a file from the EFI file system.AeMark a frame as free.BaMark a frame as used (allocated).CfHelper to build a STAR value for a pure 64-bit kernel.AjNested Task mask (bit 14).kNested TaskDn<strong>Page Size</strong> (bit 7): <strong>must be 1</strong> for 2 MiB leaf.Dn<strong>Page Size</strong> (bit 7): <strong>must be 1</strong> for 1 GiB leaf.Dk<strong>PAT</strong> (Page Attribute Table) selector for 2 MiB mappings \xe2\x80\xa6Dk<strong>PAT</strong> (Page Attribute Table) selector for 1 GiB mappings \xe2\x80\xa6Eh<strong>PAT</strong> (bit 7) \xe2\x80\x94 <strong>PAT selector bit 2</strong> for 4 KiB mappings.CiPCLMULQDQ (Carry-less multiply) instruction is supported.AiParity Flag mask (bit 2).kParity FlagAgBit 31 \xe2\x80\x94 Paging (PG).Bmpage-aligned physical base actually allocatedCbReturn the full physical address of the PML4 base.AiPrivilege Levels (x86-64)BdBits 0\xe2\x80\x932 \xe2\x80\x94 Reserved (must be 0).B`Bit 15 \xe2\x80\x94 Reserved (must be 0).CmBits 5\xe2\x80\x937 \xe2\x80\x94 Reserved (read as zero, must be written as \xe2\x80\xa6CbBits 5\xe2\x80\x9311 \xe2\x80\x94 Reserved (must be 0 when written).CaBit 19 \xe2\x80\x94 Reserved (must be 0 for current CPUs).AcBit 9 \xe2\x80\x94 Reserved.AjBits 52\xe2\x80\x9363 \xe2\x80\x94 Reserved.AjBits 23\xe2\x80\x9363 \xe2\x80\x94 Reserved.AdBit 16 \xe2\x80\x94 Reserved.AdBit 19 \xe2\x80\x94 Reserved.AjBits 22\xe2\x80\x9363 \xe2\x80\x94 Reserved.AjResume Flag mask (bit 16).kResume FlagAjPhysical page of the PML4.ChRSDP (ACPI 2.0+) physical address, or 0 if not provided.BnStrongly-typed segment selectors for long modeBdGDT selector values (CS/DS/\xe2\x80\xa6/TSS).BbAES-NI instructions are supported.AnCLFLUSH instruction supported.Dk<strong>Dirty</strong> (bit 6): set by CPU on first write to this 2 MiB \xe2\x80\xa6Dk<strong>Dirty</strong> (bit 6): set by CPU on first write to this 1 GiB \xe2\x80\xa6BiDirty (bit 6): set by CPU on first write.BfBit 14 \xe2\x80\x94 FFXSR: Fast FXSAVE/FXRSTOR.AnDescriptor index (bits 3..15).CjBit 18 \xe2\x80\x94 INTWB: Interruptible WBINVD/WBNOINVD enable \xe2\x80\xa6CaBit 13 \xe2\x80\x94 LMSLE: Long Mode Segment Limit Enable.AfBase model (bits 7:4).CeMOVBE instruction (move with byte swap) is supported.BnBit 17 \xe2\x80\x94 PCIDE: Process-Context Identifiers.Bn36-bit Page Size Extension (PSE-36) supported.CeSupplemental SSE3 (SSSE3) instructions are supported.Bf0 = read or execute. 1 = write access.jBits: 1..2ChXSAVE/XRSTOR processor state management instructions \xe2\x80\xa6lBits: 53..54lBits: 54..55DnWrite a 64-bit value to the given <strong>Model-Specific Register </strong>\xe2\x80\xa6BlEncode into <code>Pde2M</code> (2 MiB leaf).C`Encode into <code>PtEntry4k</code> (4 KiB leaf).DiConvenience constructor for a <strong>Trap Gate</strong> (type 0xF, S=0).ClReturns the 0-based array index into <code>TSS.ist[]</code>.AiUEFI Memory Map UtilitiesEfUnmap a single <strong>4 KiB</strong> page at <code>va</code>. Returns Err if missing.BaThermal Monitor and ACPI support.BjOn-chip APIC hardware present and enabled.BnConditional Move (CMOV) instruction supported.CiCMPXCHG16B instruction (Compare-and-swap 16 bytes) is \xe2\x80\xa6Ch16-bit floating-point conversion instructions (F16C) \xe2\x80\xa6ChFXSAVE/FXRSTOR instructions for FPU/MMX state supported.BhI/O Privilege Level mask (bits 12\xe2\x80\x9313).AlI/O Privilege Level (2 bits)CjBit 12 \xe2\x80\x94 LA57: 57-bit linear addresses (5-level paging).CiExecutes a closure with exclusive access to the inner \xe2\x80\xa6BmMemory Type Range Registers (MTRR) supported.CaProcess-context identifiers (PCID) are supported.CbPerformance Debug Capability MSR (PDCM) available.jBits: 2..3BiSilicon debug interface (SDBG) available.CcBit 21 \xe2\x80\x94 SMAP: Supervisor Mode Access Prevention.CfBit 20 \xe2\x80\x94 SMEP: Supervisor Mode Execution Prevention.AlBit 14 \xe2\x80\x94 SMXE: SMX Enable.BmStreaming SIMD Extensions 2 (SSE2) supported.CgStreaming SIMD Extensions 3 (SSE3) instructions are \xe2\x80\xa6CiBit 12 \xe2\x80\x94 SVME: Secure Virtual Machine Enable (AMD SVM).BmBit 20 \xe2\x80\x94 UAIE: Upper Address Ignore Enable.CbBit 11 \xe2\x80\x94 UMIP: User-Mode Instruction Prevention.Cb0 = supervisor (CPL 0\xe2\x80\x932). 1 = user mode (CPL 3).mUser (bit 2).0BfUser (bit 2): user-mode access if set.1Dh<strong>User/Supervisor</strong> (bit 2): allow user-mode access if set.2BiBit 13 \xe2\x80\x94 VMXE: VMX Enable (Intel VT-x).BhxTPR update control (xTPR) is supported.DcSets the provided <code>PageDirectoryPointerTable</code> at the \xe2\x80\xa6DfZeroes the <code>PageDirectoryPointerTable</code> (PDPT) in this frameE`Sets the provided <code>PageMapLevel4</code> at the specified <code>page</code>.DoEarly <strong>boot stack</strong> memory placed in a dedicated BSS section, \xe2\x80\xa6BfMSR index for <code>IA32_LSTAR</code>.D`A page base address (lower <code>S::SHIFT</code> bits are zero).0ChA guard that releases a <code>Mutex</code> when dropped.0ClMapper capable of temporarily viewing physical frames as \xe2\x80\xa6DeLow 8 bytes of a 64-bit <em>Available TSS</em> descriptor (type = \xe2\x80\xa6AkThe result of a table walk.BkMust be zero. Reserved by the architecture.000BkAlign down to page boundary <code>S</code>.CnMask of the alpha channel within a pixel (often 0x00000000 \xe2\x80\xa6kBits: 0..32CcPage that contains <code>addr</code> (aligns down).DmRead the current <strong>CS</strong> selector (used as a sensible default \xe2\x80\xa6AhSignal End-of-Interrupt.AmExtended family (bits 27:20).CbPopulate from an L3 <code>Pdpte</code> (non-leaf).CfPopulate from an L4 <code>Pml4Entry</code> (non-leaf).CnReturn the raw numeric value to write into an IDT gate\xe2\x80\x99s \xe2\x80\xa6CcMask of the green channel within a pixel (e.g., \xe2\x80\xa6C`Hypervisor present (running under a hypervisor).Bgx86-64 Interrupt Descriptor Table (IDT)CkVirtual layout for IST stacks: per-CPU \xc3\x97 per-IST slots \xe2\x80\xa6CiInterrupt Stack Table entries (alternate hard stacks, \xe2\x80\xa6ClKernel stack top used on CPL3\xe2\x86\x92CPL0 transitions (loaded \xe2\x80\xa6EgGreedy region map: tiles <code>[va .. va+len)</code> to <code>[pa .. pa+len)</code> \xe2\x80\xa6DkGreedy region mapping: tiles <code>[virt_start .. virt_start+len)</code>\xe2\x80\xa6CjIf present, return the physical page of the next-level \xe2\x80\xa6Eg<strong>Execute Disable</strong> / NX: disallow instruction fetch if <code>true</code>.0AdNo-Execute (bit 63).000Cg<strong>No-Execute</strong> (NX, bit 63 / XD on Intel).1CgBit 10 \xe2\x80\x94 OSXMMEXCPT: OS supports unmasked SIMD FP \xe2\x80\xa6AaMemory Page TableCfReleases the lock previously acquired by this context.BiBit 21 \xe2\x80\x94 AIBRSE: Automatic IBRS Enable.BlCPL-qualified debug store area is supported.Bl64-bit DS area for debug store is supported.AhBase family (bits 11:8).CeBit 3 \xe2\x80\x94 GEWBED (AMD K6 only): Global EWBE# Disable.De<strong>Global</strong> (bit 8): TLB entry not flushed on CR3 reload.0CdGlobal (bit 8): TLB entry not flushed on CR3 reload.BmBit 9 \xe2\x80\x94 OSFXSR: OS supports FXSAVE/FXRSTOR.B`POPCNT instruction is supported.ClRDRAND instruction (hardware random number generator) is \xe2\x80\xa6CjBit 2 \xe2\x80\x94 SEWBED (AMD K6 only): Speculative EWBE# Disable.CkStreaming SIMD Extensions 4.1 (SSE4.1) instructions are \xe2\x80\xa6CkStreaming SIMD Extensions 4.2 (SSE4.2) instructions are \xe2\x80\xa6Cgx2APIC mode is supported (Extended APIC ID register \xe2\x80\xa6Bgpage-aligned VMA start used for mappingBbAES-NI instructions are supported.AnCLFLUSH instruction supported.Dk<strong>Dirty</strong> (bit 6): set by CPU on first write to this 2 MiB \xe2\x80\xa6Dk<strong>Dirty</strong> (bit 6): set by CPU on first write to this 1 GiB \xe2\x80\xa6BiDirty (bit 6): set by CPU on first write.BfBit 14 \xe2\x80\x94 FFXSR: Fast FXSAVE/FXRSTOR.AnDescriptor index (bits 3..15).CjBit 18 \xe2\x80\x94 INTWB: Interruptible WBINVD/WBNOINVD enable \xe2\x80\xa6CaBit 13 \xe2\x80\x94 LMSLE: Long Mode Segment Limit Enable.AfBase model (bits 7:4).CeMOVBE instruction (move with byte swap) is supported.BnBit 17 \xe2\x80\x94 PCIDE: Process-Context Identifiers.Bn36-bit Page Size Extension (PSE-36) supported.CeSupplemental SSE3 (SSSE3) instructions are supported.Bf0 = read or execute. 1 = write access.jBits: 1..2ChXSAVE/XRSTOR processor state management instructions \xe2\x80\xa6lBits: 53..54lBits: 54..55Dn<code>IA32_STAR</code> \xe2\x80\x94 System Call Target &amp; Segment Selectors (MSR \xe2\x80\xa6BdTwo bytes of an IDT entry that pack:ChWhere the kernel executes (VMA), matches your linker \xe2\x80\xa60DaVirtual base address of the <strong>kernel-stack region</strong>.DlHardware <strong>Present</strong> bit position shared across levels (bit 0).AaDecoded PDE kind.CmA <code>Mutex</code> backed by a <code>RawTicket</code> lock.DfHigh 8 bytes of a 64-bit TSS descriptor: <code>base[63:32]</code>, \xe2\x80\xa6CaVirtual memory page base for size <code>S</code>.0AgBrand index (bits 7:0).Cj64-bit GDT code/data descriptor encodings (typed builders)CbMinimal Bitmap-based Physical Memory Manager (PMM)AjKernel Framebuffer helpersAbGOP for the KernelCdPopulate from an L2 <code>Pde2M</code> (2 MiB leaf).ChPopulate from an L1 <code>PtEntry4k</code> (4 KiB leaf).DbInitializes the cell at most once and returns <code>&amp;T</code>.DnByte offset from the <strong>base of this TSS</strong> to the start of the \xe2\x80\xa6CjConvenience: compute the 16-byte\xe2\x80\x93aligned top given a \xe2\x80\xa6CiACPI (Advanced Configuration and Power Interface) SupportBgKernel Configuration and Boot InterfaceChMain kernel loop, running with all memory (including \xe2\x80\xa6BbQEMU Development and Debug SupportDg<code>kernel_sync</code> \xe2\x80\x94 kernel-friendly synchronization primitivesAfVirtual Memory SupportfSafetyCiCreate from a raw value that must already be aligned. \xe2\x80\xa6AlOverflow Flag mask (bit 11).mOverflow FlagCmParse a 64-bit little-endian x86-64 ELF image and collect \xe2\x80\xa6ClHHDM-based <code>PhysMapper</code> for Kernel Virtual MemoryDnMap a 4 KiB physical frame and get a <strong>mutable</strong> reference to \xe2\x80\xa6lBits: 56..6400lBits: 16..3200BjContext ID (CNXT-ID) feature is supported.jBits: 0..1DnSet the <em>current</em> GS base (used by <code>gs:</code> memory references).CnInitialize this entry with a handler function and return a \xe2\x80\xa6CeBit 17 \xe2\x80\x94 MCOMMIT: MCOMMIT instruction enable (AMD).BiMONITOR/MWAIT instructions are supported.BlOS has enabled XSAVE/XRSTOR via CR4.OSXSAVE.CbBit 18 \xe2\x80\x94 OSXSAVE: OS uses XSAVE/XRSTOR and XCR0.Dm<strong>P</strong> \xe2\x80\x93 Present bit. Must be <code>1</code> for a valid entry.Ch0 = non-present page. 1 = protection violation (page \xe2\x80\xa6A`Present (bit 0).0BdPresent (bit 0): valid entry if set.1Ce<strong>Present</strong> (bit 0): valid entry if set.2AgSign Flag mask (bit 7).iSign FlagAgTrap Flag mask (bit 8).iTrap FlagAgZero Flag mask (bit 6).iZero FlagCkBits 0\xe2\x80\x9363 \xe2\x80\x94 64-bit RIP target for <code>syscall</code>.BnEncode into <code>Pdpte1G</code> (1 GiB leaf).BmUEFI Bootloader for Higher-Half x86-64 KernelBiBit 21 \xe2\x80\x94 AIBRSE: Automatic IBRS Enable.BlCPL-qualified debug store area is supported.Bl64-bit DS area for debug store is supported.AhBase family (bits 11:8).CeBit 3 \xe2\x80\x94 GEWBED (AMD K6 only): Global EWBE# Disable.De<strong>Global</strong> (bit 8): TLB entry not flushed on CR3 reload.0CdGlobal (bit 8): TLB entry not flushed on CR3 reload.BmBit 9 \xe2\x80\x94 OSFXSR: OS supports FXSAVE/FXRSTOR.B`POPCNT instruction is supported.ClRDRAND instruction (hardware random number generator) is \xe2\x80\xa6CjBit 2 \xe2\x80\x94 SEWBED (AMD K6 only): Speculative EWBE# Disable.CkStreaming SIMD Extensions 4.1 (SSE4.1) instructions are \xe2\x80\xa6CkStreaming SIMD Extensions 4.2 (SSE4.2) instructions are \xe2\x80\xa6Cgx2APIC mode is supported (Extended APIC ID register \xe2\x80\xa6BkHandle to a single, concrete address space.CkUEFI-backed frame allocator: hands out zeroed 4 KiB frames.D`Bit layout of a <strong>64-bit code segment</strong> descriptor.CoBit layout of a <strong>data/stack segment</strong> descriptor.BmPointer format required by <code>lgdt</code>.CiTarget table/level produced by <code>ensure_chain</code>.CiSize of the unmapped guard page at the bottom of each \xe2\x80\xa6CbPhysical memory page base for size <code>S</code>.0BaMarker trait for typed selectors.CgA minimal, lock-free, spin-based <code>OnceCell</code>.0C`Minimal state for SYSCALL/SYSRET-based syscalls.DbChecked add of an offset, returning <code>None</code> on overflow.ChPointer to the current running task (kernel struct). \xe2\x80\xa6AmDirection Flag mask (bit 10).nDirection FlagAiBit 2 \xe2\x80\x94 Emulation (EM).fSafetyDhView the <strong>currently active</strong> address space by reading CR3.CaProvides the <code>Ia32GsBaseMsrExt</code> trait.BmProvides the <code>Ia32GsBaseMsr</code> type.CfKernel Memory Allocation and Virtual Memory ManagementC`Bits 12\xe2\x80\x9351 \xe2\x80\x94 PML4 physical base &gt;&gt; 12.CmBuild a PML4 entry that points to the given PDPT page and \xe2\x80\xa6DjCreate a new, present <code>PtEntry4k</code> with the specified flags, \xe2\x80\xa6BnAttempts to acquire the lock without blocking.Ce1 = caused by reserved bit set in a paging structure.AaAccessed (bit 5).000Dm<strong>Accessed</strong> (A, bit 5): set by CPU on first access via this \xe2\x80\xa61lBits: 32..4000AhCarry Flag mask (bit 0).jCarry FlagAlProcessor type (bits 13:12).CmBit 16 \xe2\x80\x94 FSGSBASE: Enable {R,W}{D,}FSBASE/GSBASE in CPL \xe2\x80\xa6AfID Flag mask (bit 21).AoID Flag: allows toggling CPUID.lBits: 48..5200kBits: 0..1600lBits: 32..64AgStepping ID (bits 3:0).AaWritable (bit 1).0BcWritable (bit 1): write permission.1Cd<strong>Writable</strong> (bit 1): write permission.2Bl1 = shadow stack access (if CET-SS enabled).fSafetyBgLocal APIC supports TSC-deadline timer.EjUnmap a single <strong>4 KiB</strong> page at <code>va</code>. Returns Err if not a 4K \xe2\x80\xa6ClGreedy unmap of a region: clears whole 1G/2M leaves when \xe2\x80\xa6CmWhether interrupts were enabled (IF=1) when the guard was \xe2\x80\xa6lBits: 56..6400lBits: 16..3200BjContext ID (CNXT-ID) feature is supported.jBits: 0..1DnSet the <em>current</em> GS base (used by <code>gs:</code> memory references).CeBit 17 \xe2\x80\x94 MCOMMIT: MCOMMIT instruction enable (AMD).BiMONITOR/MWAIT instructions are supported.BlOS has enabled XSAVE/XRSTOR via CR4.OSXSAVE.CbBit 18 \xe2\x80\x94 OSXSAVE: OS uses XSAVE/XRSTOR and XCR0.Dm<strong>P</strong> \xe2\x80\x93 Present bit. Must be <code>1</code> for a valid entry.Ch0 = non-present page. 1 = protection violation (page \xe2\x80\xa6A`Present (bit 0).0BdPresent (bit 0): valid entry if set.1Ce<strong>Present</strong> (bit 0): valid entry if set.2AgSign Flag mask (bit 7).iSign FlagAgTrap Flag mask (bit 8).iTrap FlagAgZero Flag mask (bit 6).iZero FlagDbModel-Specific Register: current <strong>GS base address</strong>.0DfMasks further maskable interrupts upon entry (clears <code>IF</code>).AhKernel function pointer.CkVirtual address used in descriptor-table pointers (with \xe2\x80\xa6CcPrincipal raw memory address (virtual or physical).0CdThe Page Directory (L2): 512 entries, 4 KiB-aligned.AnThe top-level page map (PML4).AhDecoded PDPT entry kind.ClMapper capable of temporarily viewing physical frames as \xe2\x80\xa6CkA guard that releases a <code>SpinLock</code> when dropped.0CjEnd of userspace VA range after which Kernel space begins.0EePrevent default auto-<code>Send</code>/<code>Sync</code>; we add them with bounds \xe2\x80\xa6000AfThe kernel entry pointBcAddress Space (x86-64, PML4-rooted)Df<strong>Page Cache Disable</strong> (PCD): disable caching (PAT bit1).0AfCache Disable (bit 4).000Di<strong>Page Cache Disable</strong> (PCD, bit 4): disable caching if set.CnCache Disable (bit 4) \xe2\x80\x94 <strong>PAT selector bit 1</strong>.FdBuild a <strong>64-bit code</strong> descriptor (execute+read, <code>L=1</code>, <code>DB=0</code>).DnBuild a <strong>data/stack</strong> descriptor (read/write, <code>L=0</code>).CfPopulate from an L3 <code>Pdpte1G</code> (1 GiB leaf).CnExtract <code>RPL</code> from a 16-bit segment selector value.CmConvenience: initialize both GS bases to the same per-CPU \xe2\x80\xa6DkInitialize the <strong>global Interrupt Descriptor Table (IDT)</strong> \xe2\x80\xa6CjVirtual layout for <strong>per-CPU kernel stacks</strong>.D`Allocate &amp; map an IST stack with a 4 KiB guard below it. \xe2\x80\xa6CiMaximum usable IST bytes per slot (excludes the 4 KiB \xe2\x80\xa6CfHelper to build a STAR value for a pure 64-bit kernel.BiNon-leaf PDE with common kernel RW flags.BeLeaf PDE with common kernel RW flags.BkNon-leaf PDPTE with common kernel RW flags.BgLeaf PDPTE with common kernel RW flags.AhGet the 2 MiB page base.BlGet the Page Directory base (4 KiB-aligned).AhGet the 1 GiB page base.AhGet the 4 KiB page base.DjReads the current value of the <strong>CR3 register</strong> (the page \xe2\x80\xa6AiAdjust Flag mask (bit 4).kAdjust FlagAlExtended model (bits 19:16).lBits: 55..5600lBits: 53..540AjNested Task mask (bit 14).kNested TasklBits: 47..4800Dn<strong>Page Size</strong> (bit 7): <strong>must be 1</strong> for 2 MiB leaf.Dn<strong>Page Size</strong> (bit 7): <strong>must be 1</strong> for 1 GiB leaf.Dk<strong>PAT</strong> (Page Attribute Table) selector for 2 MiB mappings \xe2\x80\xa6Dk<strong>PAT</strong> (Page Attribute Table) selector for 1 GiB mappings \xe2\x80\xa6Eh<strong>PAT</strong> (bit 7) \xe2\x80\x94 <strong>PAT selector bit 2</strong> for 4 KiB mappings.CiPCLMULQDQ (Carry-less multiply) instruction is supported.AiParity Flag mask (bit 2).kParity FlagAgBit 31 \xe2\x80\x94 Paging (PG).BdBits 0\xe2\x80\x932 \xe2\x80\x94 Reserved (must be 0).CmBits 5\xe2\x80\x937 \xe2\x80\x94 Reserved (read as zero, must be written as \xe2\x80\xa6CbBits 5\xe2\x80\x9311 \xe2\x80\x94 Reserved (must be 0 when written).AjBits 52\xe2\x80\x9363 \xe2\x80\x94 Reserved.AdBit 16 \xe2\x80\x94 Reserved.AdBit 19 \xe2\x80\x94 Reserved.AjResume Flag mask (bit 16).kResume FlaglBits: 44..4500Ed<strong>S</strong> \xe2\x80\x93 System bit (must be <code>0</code> for interrupt/trap gates).AaAccessed (bit 5).000Dm<strong>Accessed</strong> (A, bit 5): set by CPU on first access via this \xe2\x80\xa61lBits: 32..4000AhCarry Flag mask (bit 0).jCarry FlagAlProcessor type (bits 13:12).CmBit 16 \xe2\x80\x94 FSGSBASE: Enable {R,W}{D,}FSBASE/GSBASE in CPL \xe2\x80\xa6AfID Flag mask (bit 21).AoID Flag: allows toggling CPUID.lBits: 48..5200kBits: 0..1600lBits: 32..64AgStepping ID (bits 3:0).AaWritable (bit 1).0BcWritable (bit 1): write permission.1Cd<strong>Writable</strong> (bit 1): write permission.2Dk<strong>Page Write-Through</strong> (PWT): write-through policy (PAT bit0).0AfWrite-Through (bit 3).000Dk<strong>Page Write-Through</strong> (PWT, bit 3): write-through caching \xe2\x80\xa6CnWrite-Through (bit 3) \xe2\x80\x94 <strong>PAT selector bit 0</strong>.FeBit masks for <code>BootPixelFormat::Bitmask</code>. For <code>Rgb</code>/<code>Bgr</code>, these \xe2\x80\xa6ChWrite a single byte to a kernel-chosen \xe2\x80\x9cdebug\xe2\x80\x9d sink.Di<code>PhysMapper</code> implementation for kernels with a higher-half \xe2\x80\xa6CnPer-CPU stride in the IST region (bytes). Leave ample room \xe2\x80\xa6DkInformation the kernel needs right after <code>ExitBootServices</code>. \xe2\x80\xa6BfPage-fault error code layout (x86-64).DjMinimal allocator that hands out <strong>4 KiB</strong> page-table frames.AgVirtual memory address.0DiBuild a selector from <code>{index, ti}</code> and this <code>RPL</code>.CoThe <em>effective requester level</em> that participates in \xe2\x80\xa6CmReturns the physical address of the RSDP if present, else \xe2\x80\xa6DiCreate a <code>Cr3</code> value from a PML4 physical base address and \xe2\x80\xa6DjMake this an <strong>Interrupt Gate</strong> (type 0xE, <code>S=0</code>).DmConvenience constructor for an <strong>Interrupt Gate</strong> (type 0xE, \xe2\x80\xa6CoChange per-page protection from RW to RX by unmapping &amp; \xe2\x80\xa6C`Size of a single memory descriptor in bytes (\xe2\x80\xa6Db4 KiB <strong>user RO+NX</strong> mapping (read-only, no execute).Bl1 = protection-key violation (if CR4.PKE=1).Cn<strong>Protection key</strong> (PKU) or OS-use (bits 59..62).0BaProtection Key / OS use (59..62).000Cg<strong>Protection Key / OS use</strong> (bits 59..62).1kBits: 0..32lBits: 54..550BdDebugging extensions (DE) supported.BcBit 3 \xe2\x80\x94 DE: Debugging Extensions.BcDebug Store (DS) feature supported.AmExtended family (bits 27:20).C`Hypervisor present (running under a hypervisor).AdNo-Execute (bit 63).000Cg<strong>No-Execute</strong> (NX, bit 63 / XD on Intel).1CgBit 10 \xe2\x80\x94 OSXMMEXCPT: OS supports unmasked SIMD FP \xe2\x80\xa6AjSelf-Snoop (SS) supported.BjTable Indicator (bit 2): 0 = GDT, 1 = LDT.AoThermal Monitor (TM) supported.AiAdjust Flag mask (bit 4).kAdjust FlagAlExtended model (bits 19:16).lBits: 55..5600lBits: 53..540AjNested Task mask (bit 14).kNested TasklBits: 47..4800Dn<strong>Page Size</strong> (bit 7): <strong>must be 1</strong> for 2 MiB leaf.Dn<strong>Page Size</strong> (bit 7): <strong>must be 1</strong> for 1 GiB leaf.Dk<strong>PAT</strong> (Page Attribute Table) selector for 2 MiB mappings \xe2\x80\xa6Dk<strong>PAT</strong> (Page Attribute Table) selector for 1 GiB mappings \xe2\x80\xa6Eh<strong>PAT</strong> (bit 7) \xe2\x80\x94 <strong>PAT selector bit 2</strong> for 4 KiB mappings.CiPCLMULQDQ (Carry-less multiply) instruction is supported.AiParity Flag mask (bit 2).kParity FlagAgBit 31 \xe2\x80\x94 Paging (PG).BdBits 0\xe2\x80\x932 \xe2\x80\x94 Reserved (must be 0).CmBits 5\xe2\x80\x937 \xe2\x80\x94 Reserved (read as zero, must be written as \xe2\x80\xa6CbBits 5\xe2\x80\x9311 \xe2\x80\x94 Reserved (must be 0 when written).AjBits 52\xe2\x80\x9363 \xe2\x80\x94 Reserved.AdBit 16 \xe2\x80\x94 Reserved.AdBit 19 \xe2\x80\x94 Reserved.AjResume Flag mask (bit 16).kResume FlaglBits: 44..4500Ed<strong>S</strong> \xe2\x80\x93 System bit (must be <code>0</code> for interrupt/trap gates).CjEarliest boot stack size. This stack is used only when \xe2\x80\xa6ClPixel format tag compatible with UEFI GOP. We avoid Rust \xe2\x80\xa6CnPer-IST stride inside one CPU\xe2\x80\x99s IST area (bytes). With 7 \xe2\x80\xa6BlFluent builder for an <code>IdtEntry</code>.AhPhysical memory address.0B`Strongly-typed selector wrapper.CcVirtual offset inside the HHDM where we map the \xe2\x80\xa6CkEffective model per SDM: if base family in {0x06, 0x0F} \xe2\x80\xa6CnBest-effort TSC frequency estimate in Hz. Order: CPUID.15H \xe2\x80\xa6CkLinear framebuffer base address (CPU physical address). \xe2\x80\xa6BlFetch an optimal framebuffer for the Kernel.AmCall once in very early boot.AmInitial APIC ID (bits 31:24).Df<strong>Next-level table physical address</strong> (bits 12..51, 4 \xe2\x80\xa6CeNext-level table physical address (bits 12..51, 4 \xe2\x80\xa6Da<strong>Next-level table physical address</strong> (bits 12..51).DbPhysical address bits <strong>51:12</strong> (4 KiB-aligned base).DbPhysical address bits <strong>51:21</strong> (2 MiB-aligned base).DbPhysical address bits <strong>51:30</strong> (1 GiB-aligned base).lBits: 52..5300CeAdvanced Vector Extensions (AVX) instructions are \xe2\x80\xa6AgBrand index (bits 7:0).B`CMPXCHG8B instruction supported.BgDirect Cache Access (DCA) is supported.CbBit 1 \xe2\x80\x94 DPE (AMD K6 only): Data Prefetch Enable.lBits: 45..4700Cl<strong>DPL</strong> \xe2\x80\x93 Descriptor Privilege Level (0..=3).CnEnhanced <code>SpeedStep</code> Technology (EST) is supported.CdFused Multiply-Add (FMA) instructions are supported.AnOn-chip FPU (x87 FPU) present.BkHyper-Threading Technology (HTT) supported.Dh<strong>IST</strong> \xe2\x80\x93 Interrupt Stack Table index (0 disables IST \xe2\x80\xa6BnBit 4 \xe2\x80\x94 L2D (AMD K6 only): L2 Cache Disable.BmBit 10 \xe2\x80\x94 LMA: Long Mode Active (read-only).B`Bit 8 \xe2\x80\x94 LME: Long Mode Enable.BkMachine Check Architecture (MCA) supported.BhMachine Check Exception (MCE) supported.BdBit 6 \xe2\x80\x94 MCE: Machine-Check Enable.AiMMX technology supported.CaModel-Specific Registers (RDMSR/WRMSR) supported.BbBit 11 \xe2\x80\x94 NXE: No-Execute Enable.AlOverflow Flag mask (bit 11).mOverflow FlagBlPhysical Address Extensions (PAE) supported.BjBit 5 \xe2\x80\x94 PAE: Physical Address Extension.BePage Attribute Table (PAT) supported.BePending Break Enable (PBE) supported.CaBit 4 \xe2\x80\x94 PCD: Page-level Cache Disable for PML4.CeBit 8 \xe2\x80\x94 PCE: Performance-Monitoring Counter Enable.BcPage Global Enable (PGE) supported.BbBit 7 \xe2\x80\x94 PGE: Page Global Enable.BgBit 22 \xe2\x80\x94 PKE: Protection Keys Enable.BePage-Size Extensions (PSE) supported.BdBit 4 \xe2\x80\x94 PSE: Page Size Extensions.BhProcessor Serial Number (PSN) available.kBits: 0..640CaBit 1 \xe2\x80\x94 PVI: Protected-Mode Virtual Interrupts.CaBit 3 \xe2\x80\x94 PWT: Page-level Write-Through for PML4.BfRequested Privilege Level (bits 0..1).BfBit 0 \xe2\x80\x94 SCE: System Call Extensions.BhSYSENTER/SYSEXIT instructions supported.BjSafer Mode Extensions (SMX) are supported.BjStreaming SIMD Extensions (SSE) supported.CkBits 0\xe2\x80\x9363 \xe2\x80\x94 64-bit RIP target for <code>syscall</code>.BlBit 15 \xe2\x80\x94 TCE: Translation Cache Extension.BeThermal Monitor 2 (TM2) is supported.CaTime-Stamp Counter (RDTSC) instruction available.BbBit 2 \xe2\x80\x94 TSD: Time Stamp Disable.lBits: 40..4400Eb<strong>Type</strong> \xe2\x80\x93 0xE = <em>Interrupt gate</em>, 0xF = <em>Trap gate</em>.BmVirtual 8086 mode extensions (VME) supported.BlBit 0 \xe2\x80\x94 VME: Virtual-8086 Mode Extensions.BoVirtual Machine Extensions (VMX) are supported.kBits: 0..32lBits: 54..550BdDebugging extensions (DE) supported.BcBit 3 \xe2\x80\x94 DE: Debugging Extensions.BcDebug Store (DS) feature supported.AmExtended family (bits 27:20).C`Hypervisor present (running under a hypervisor).AdNo-Execute (bit 63).000Cg<strong>No-Execute</strong> (NX, bit 63 / XD on Intel).1CgBit 10 \xe2\x80\x94 OSXMMEXCPT: OS supports unmasked SIMD FP \xe2\x80\xa6AjSelf-Snoop (SS) supported.BjTable Indicator (bit 2): 0 = GDT, 1 = LDT.AoThermal Monitor (TM) supported.AoIndicates for whom to allocate.CiMinimal bitmap-based PMM for 4K frames in a fixed region.CfLoader mapper: treat low physical memory frames as \xe2\x80\xa6AnBit 30 \xe2\x80\x94 Cache Disable (CD).fSafetyAfPost-bringup clearing.CmEffective family per SDM: if base family == 0x0F \xe2\x86\x92 base \xe2\x80\xa6DiEnsure that the non-leaf chain for <code>va</code> exists down to the \xe2\x80\xa60DlTotal framebuffer size in <strong>bytes</strong>. Helpful for bounds checks.DeInitialize and load <strong>GDT + TSS</strong> for the bootstrap CPU.EkReturn the <strong>guard page</strong> base for <code>(cpu_id, ist_idx)</code> (1..=7). \xe2\x80\xa6BcTyped <code>X84_64</code> RegistersDkMap a new <strong>kernel stack</strong> at a predefined virtual address \xe2\x80\xa6ClMaximum usable bytes for a single kernel stack (excludes \xe2\x80\xa6AmBit 5 \xe2\x80\x94 Numeric Error (NE).Eh<strong>OS-available (low)</strong>: bits 9..11 (masked to 3 bits in <code>to_*</code>).0AnOS-available low (bits 9..11).000Dl<strong>OS-available low</strong> (bits 9..11): not interpreted by hardware.1AhGet the Page Table base.BjGet the PDPT base address (4 KiB-aligned).BaThermal Monitor and ACPI support.BjOn-chip APIC hardware present and enabled.BnConditional Move (CMOV) instruction supported.CiCMPXCHG16B instruction (Compare-and-swap 16 bytes) is \xe2\x80\xa6AmDirection Flag mask (bit 10).nDirection FlagAiBit 2 \xe2\x80\x94 Emulation (EM).Ch16-bit floating-point conversion instructions (F16C) \xe2\x80\xa6ChFXSAVE/FXRSTOR instructions for FPU/MMX state supported.BhI/O Privilege Level mask (bits 12\xe2\x80\x9313).AlI/O Privilege Level (2 bits)CjBit 12 \xe2\x80\x94 LA57: 57-bit linear addresses (5-level paging).BmMemory Type Range Registers (MTRR) supported.CaProcess-context identifiers (PCID) are supported.CbPerformance Debug Capability MSR (PDCM) available.C`Bits 12\xe2\x80\x9351 \xe2\x80\x94 PML4 physical base &gt;&gt; 12.jBits: 2..3Ce1 = caused by reserved bit set in a paging structure.BiSilicon debug interface (SDBG) available.Bl1 = shadow stack access (if CET-SS enabled).CcBit 21 \xe2\x80\x94 SMAP: Supervisor Mode Access Prevention.CfBit 20 \xe2\x80\x94 SMEP: Supervisor Mode Execution Prevention.AlBit 14 \xe2\x80\x94 SMXE: SMX Enable.BmStreaming SIMD Extensions 2 (SSE2) supported.CgStreaming SIMD Extensions 3 (SSE3) instructions are \xe2\x80\xa6CiBit 12 \xe2\x80\x94 SVME: Secure Virtual Machine Enable (AMD SVM).BgLocal APIC supports TSC-deadline timer.BmBit 20 \xe2\x80\x94 UAIE: Upper Address Ignore Enable.CbBit 11 \xe2\x80\x94 UMIP: User-Mode Instruction Prevention.Cb0 = supervisor (CPL 0\xe2\x80\x932). 1 = user mode (CPL 3).mUser (bit 2).0BfUser (bit 2): user-mode access if set.1Dh<strong>User/Supervisor</strong> (bit 2): allow user-mode access if set.2BiBit 13 \xe2\x80\x94 VMXE: VMX Enable (Intel VT-x).BhxTPR update control (xTPR) is supported.BgEnter the kernel via a tiny trampoline.AmBit 3 \xe2\x80\x94 Task Switched (TS).lBits: 52..5300CeAdvanced Vector Extensions (AVX) instructions are \xe2\x80\xa6AgBrand index (bits 7:0).B`CMPXCHG8B instruction supported.BgDirect Cache Access (DCA) is supported.CbBit 1 \xe2\x80\x94 DPE (AMD K6 only): Data Prefetch Enable.lBits: 45..4700Cl<strong>DPL</strong> \xe2\x80\x93 Descriptor Privilege Level (0..=3).CnEnhanced <code>SpeedStep</code> Technology (EST) is supported.CdFused Multiply-Add (FMA) instructions are supported.AnOn-chip FPU (x87 FPU) present.BkHyper-Threading Technology (HTT) supported.Dh<strong>IST</strong> \xe2\x80\x93 Interrupt Stack Table index (0 disables IST \xe2\x80\xa6BnBit 4 \xe2\x80\x94 L2D (AMD K6 only): L2 Cache Disable.BmBit 10 \xe2\x80\x94 LMA: Long Mode Active (read-only).B`Bit 8 \xe2\x80\x94 LME: Long Mode Enable.BkMachine Check Architecture (MCA) supported.BhMachine Check Exception (MCE) supported.BdBit 6 \xe2\x80\x94 MCE: Machine-Check Enable.AiMMX technology supported.CaModel-Specific Registers (RDMSR/WRMSR) supported.BbBit 11 \xe2\x80\x94 NXE: No-Execute Enable.AlOverflow Flag mask (bit 11).mOverflow FlagBlPhysical Address Extensions (PAE) supported.BjBit 5 \xe2\x80\x94 PAE: Physical Address Extension.BePage Attribute Table (PAT) supported.BePending Break Enable (PBE) supported.CaBit 4 \xe2\x80\x94 PCD: Page-level Cache Disable for PML4.CeBit 8 \xe2\x80\x94 PCE: Performance-Monitoring Counter Enable.BcPage Global Enable (PGE) supported.BbBit 7 \xe2\x80\x94 PGE: Page Global Enable.BgBit 22 \xe2\x80\x94 PKE: Protection Keys Enable.BePage-Size Extensions (PSE) supported.BdBit 4 \xe2\x80\x94 PSE: Page Size Extensions.BhProcessor Serial Number (PSN) available.kBits: 0..640CaBit 1 \xe2\x80\x94 PVI: Protected-Mode Virtual Interrupts.CaBit 3 \xe2\x80\x94 PWT: Page-level Write-Through for PML4.BfRequested Privilege Level (bits 0..1).BfBit 0 \xe2\x80\x94 SCE: System Call Extensions.BhSYSENTER/SYSEXIT instructions supported.BjSafer Mode Extensions (SMX) are supported.BjStreaming SIMD Extensions (SSE) supported.CkBits 0\xe2\x80\x9363 \xe2\x80\x94 64-bit RIP target for <code>syscall</code>.BlBit 15 \xe2\x80\x94 TCE: Translation Cache Extension.BeThermal Monitor 2 (TM2) is supported.CaTime-Stamp Counter (RDTSC) instruction available.BbBit 2 \xe2\x80\x94 TSD: Time Stamp Disable.lBits: 40..4400Eb<strong>Type</strong> \xe2\x80\x93 0xE = <em>Interrupt gate</em>, 0xF = <em>Trap gate</em>.BmVirtual 8086 mode extensions (VME) supported.BlBit 0 \xe2\x80\x94 VME: Virtual-8086 Mode Extensions.BoVirtual Machine Extensions (VMX) are supported.AnBit 16 \xe2\x80\x94 Write Protect (WP).CbSet the Spurious Interrupt Vector register and \xe2\x80\xa6CgNumber of hardware IST entries supported by x86_64 TSS.BmThe size of the kernel stack in debug builds.0BfVirtual span reserved per CPU (bytes).CiA UEFI Boot Services pool allocation to back Rust\xe2\x80\x99s \xe2\x80\xa6AoBit 18 \xe2\x80\x94 Alignment Mask (AM).EjReturn <code>selector</code> with its <code>RPL</code> bits replaced by <code>self</code>.AnBit 4 \xe2\x80\x94 Extension Type (ET).BiPixel bit masks (only meaningful when \xe2\x80\xa6BiVisible width in <strong>pixels</strong>.Bg1 = instruction fetch (execute access).DoConvenience: map a <strong>per-page</strong> region using freshly allocated \xe2\x80\xa6CgDescriptor version (from UEFI). Kernel can check it \xe2\x80\xa6Ek<strong>OS-available (high)</strong>: bits 52..58 (masked to 7 bits in <code>to_*</code>\xe2\x80\xa60B`OS-available high (bits 52..58).000Dh<strong>OS-available high</strong> (bits 52..58): not interpreted by \xe2\x80\xa61CmData segment: allowed iff <code>max(CPL, RPL) \xe2\x89\xa4 DPL</code>.DkCreate a new, present <code>PdEntry</code> with the specified flags, at \xe2\x80\xa6BnCreate a 1 GiB leaf PDPTE (<code>PS=1</code>).DfCreate a non-leaf PDE that points to a Page Table (<code>PS=0</code>).ClCreate a non-leaf PDPTE that points to a Page Directory (\xe2\x80\xa6BbAES-NI instructions are supported.AfCache Disable (bit 4).000Di<strong>Page Cache Disable</strong> (PCD, bit 4): disable caching if set.CnCache Disable (bit 4) \xe2\x80\x94 <strong>PAT selector bit 1</strong>.AnCLFLUSH instruction supported.Dk<strong>Dirty</strong> (bit 6): set by CPU on first write to this 2 MiB \xe2\x80\xa6Dk<strong>Dirty</strong> (bit 6): set by CPU on first write to this 1 GiB \xe2\x80\xa6BiDirty (bit 6): set by CPU on first write.BfBit 14 \xe2\x80\x94 FFXSR: Fast FXSAVE/FXRSTOR.AnDescriptor index (bits 3..15).CjBit 18 \xe2\x80\x94 INTWB: Interruptible WBINVD/WBNOINVD enable \xe2\x80\xa6CaBit 13 \xe2\x80\x94 LMSLE: Long Mode Segment Limit Enable.AfBase model (bits 7:4).CeMOVBE instruction (move with byte swap) is supported.BnBit 17 \xe2\x80\x94 PCIDE: Process-Context Identifiers.BhSet the Page Table base (4 KiB-aligned).C`Set the 2 MiB page base (must be 2 MiB-aligned).BlSet the Page Directory base (4 KiB-aligned).C`Set the 1 GiB page base (must be 1 GiB-aligned).BhSet the 4 KiB page base (4 KiB-aligned).Bn36-bit Page Size Extension (PSE-36) supported.CeSupplemental SSE3 (SSSE3) instructions are supported.Bf0 = read or execute. 1 = write access.jBits: 1..2AfWrite-Through (bit 3).000Dk<strong>Page Write-Through</strong> (PWT, bit 3): write-through caching \xe2\x80\xa6CnWrite-Through (bit 3) \xe2\x80\x94 <strong>PAT selector bit 0</strong>.ChXSAVE/XRSTOR processor state management instructions \xe2\x80\xa6lBits: 53..54lBits: 54..55CjQuick helper to start a periodic timer (coarse values; \xe2\x80\xa6EiIf CPUID.15H exposed a TSC ratio but <strong><code>crystal_hz==0</code></strong>, you canDiBuild a <strong>user code leaf entry</strong>: read-only, executable, \xe2\x80\xa6DlBuild a <strong>user data leaf entry</strong>: writable, non-executable, \xe2\x80\xa6BaThermal Monitor and ACPI support.BjOn-chip APIC hardware present and enabled.BnConditional Move (CMOV) instruction supported.CiCMPXCHG16B instruction (Compare-and-swap 16 bytes) is \xe2\x80\xa6AmDirection Flag mask (bit 10).nDirection FlagAiBit 2 \xe2\x80\x94 Emulation (EM).Ch16-bit floating-point conversion instructions (F16C) \xe2\x80\xa6ChFXSAVE/FXRSTOR instructions for FPU/MMX state supported.BhI/O Privilege Level mask (bits 12\xe2\x80\x9313).AlI/O Privilege Level (2 bits)CjBit 12 \xe2\x80\x94 LA57: 57-bit linear addresses (5-level paging).BmMemory Type Range Registers (MTRR) supported.CaProcess-context identifiers (PCID) are supported.CbPerformance Debug Capability MSR (PDCM) available.C`Bits 12\xe2\x80\x9351 \xe2\x80\x94 PML4 physical base &gt;&gt; 12.jBits: 2..3Ce1 = caused by reserved bit set in a paging structure.BiSilicon debug interface (SDBG) available.Bl1 = shadow stack access (if CET-SS enabled).CcBit 21 \xe2\x80\x94 SMAP: Supervisor Mode Access Prevention.CfBit 20 \xe2\x80\x94 SMEP: Supervisor Mode Execution Prevention.AlBit 14 \xe2\x80\x94 SMXE: SMX Enable.BmStreaming SIMD Extensions 2 (SSE2) supported.CgStreaming SIMD Extensions 3 (SSE3) instructions are \xe2\x80\xa6CiBit 12 \xe2\x80\x94 SVME: Secure Virtual Machine Enable (AMD SVM).BgLocal APIC supports TSC-deadline timer.BmBit 20 \xe2\x80\x94 UAIE: Upper Address Ignore Enable.CbBit 11 \xe2\x80\x94 UMIP: User-Mode Instruction Prevention.Cb0 = supervisor (CPL 0\xe2\x80\x932). 1 = user mode (CPL 3).mUser (bit 2).0BfUser (bit 2): user-mode access if set.1Dh<strong>User/Supervisor</strong> (bit 2): allow user-mode access if set.2BiBit 13 \xe2\x80\x94 VMXE: VMX Enable (Intel VT-x).BhxTPR update control (xTPR) is supported.CnKeep a tiny identity map so the paging switch code remains \xe2\x80\xa60BlRaw 16-bit selector encoding (index/TI/RPL).AnAlignment Check mask (bit 18).oAlignment CheckChCLFLUSH line size in <strong>bytes</strong> (value * 8).ClBits 0\xe2\x80\x9331 \xe2\x80\x94 Compatibility-mode <code>syscall</code> EIP.DdPage that contains <code>addr</code> (aligns down to page boundary).CnExist the UEFI boot services and retain a copy of the UEFI \xe2\x80\xa6DhPixel format tag (Rgb/Bgr/Bitmask/BltOnly). If <code>BltOnly</code>, \xe2\x80\xa6BjVisible height in <strong>pixels</strong>.CoPixels per scanline (a.k.a. stride). May be &gt;= width due \xe2\x80\xa6BkLoad the Task Register with a TSS selector.CmInterrupt-gate PF handler: reads CR2 and the pushed error \xe2\x80\xa6ChCalibrate TSC Hz by measuring rdtsc delta over a PIT \xe2\x80\xa6BiBit 21 \xe2\x80\x94 AIBRSE: Automatic IBRS Enable.BlCPL-qualified debug store area is supported.Bl64-bit DS area for debug store is supported.AhBase family (bits 11:8).CeBit 3 \xe2\x80\x94 GEWBED (AMD K6 only): Global EWBE# Disable.De<strong>Global</strong> (bit 8): TLB entry not flushed on CR3 reload.0CdGlobal (bit 8): TLB entry not flushed on CR3 reload.DnSet the <em>kernel</em> GS base that becomes active after <code>swapgs</code>.BmBit 9 \xe2\x80\x94 OSFXSR: OS supports FXSAVE/FXRSTOR.B`POPCNT instruction is supported.Bl1 = protection-key violation (if CR4.PKE=1).BaProtection Key / OS use (59..62).000Cg<strong>Protection Key / OS use</strong> (bits 59..62).1ClRDRAND instruction (hardware random number generator) is \xe2\x80\xa6CjBit 2 \xe2\x80\x94 SEWBED (AMD K6 only): Speculative EWBE# Disable.CkStreaming SIMD Extensions 4.1 (SSE4.1) instructions are \xe2\x80\xa6CkStreaming SIMD Extensions 4.2 (SSE4.2) instructions are \xe2\x80\xa6Cgx2APIC mode is supported (Extended APIC ID register \xe2\x80\xa6CdRust dispatcher invoked by the low-level entry stub.DkBits 48\xe2\x80\x9363 \xe2\x80\x94 User code segment selector base for <code>sysret</code>\xe2\x80\xa6DnBuild a <strong>non-leaf (page-table) entry</strong> for a user-accessible \xe2\x80\xa6BbAES-NI instructions are supported.AfCache Disable (bit 4).000Di<strong>Page Cache Disable</strong> (PCD, bit 4): disable caching if set.CnCache Disable (bit 4) \xe2\x80\x94 <strong>PAT selector bit 1</strong>.AnCLFLUSH instruction supported.Dk<strong>Dirty</strong> (bit 6): set by CPU on first write to this 2 MiB \xe2\x80\xa6Dk<strong>Dirty</strong> (bit 6): set by CPU on first write to this 1 GiB \xe2\x80\xa6BiDirty (bit 6): set by CPU on first write.BfBit 14 \xe2\x80\x94 FFXSR: Fast FXSAVE/FXRSTOR.AnDescriptor index (bits 3..15).CjBit 18 \xe2\x80\x94 INTWB: Interruptible WBINVD/WBNOINVD enable \xe2\x80\xa6CaBit 13 \xe2\x80\x94 LMSLE: Long Mode Segment Limit Enable.AfBase model (bits 7:4).CeMOVBE instruction (move with byte swap) is supported.BnBit 17 \xe2\x80\x94 PCIDE: Process-Context Identifiers.BhSet the Page Table base (4 KiB-aligned).C`Set the 2 MiB page base (must be 2 MiB-aligned).BlSet the Page Directory base (4 KiB-aligned).C`Set the 1 GiB page base (must be 1 GiB-aligned).BhSet the 4 KiB page base (4 KiB-aligned).Bn36-bit Page Size Extension (PSE-36) supported.CeSupplemental SSE3 (SSSE3) instructions are supported.Bf0 = read or execute. 1 = write access.jBits: 1..2AfWrite-Through (bit 3).000Dk<strong>Page Write-Through</strong> (PWT, bit 3): write-through caching \xe2\x80\xa6CnWrite-Through (bit 3) \xe2\x80\x94 <strong>PAT selector bit 0</strong>.ChXSAVE/XRSTOR processor state management instructions \xe2\x80\xa6lBits: 53..54lBits: 54..55CiModel-Specific Register: <strong>kernel GS base</strong>.0DlThe offset within a page of size <code>S</code> (<code>0..S::SIZE-1</code>).0C`Disables hardware interrupts (<code>cli</code>).DhCopy a kernel slice into an already <strong>mapped</strong> user region.CcProvides the <code>Ia32KernelGsBaseMsr</code> type.0DgUpdate entries of the global IDT <strong>in place</strong>, without \xe2\x80\xa6BcInterrupt Enable Flag mask (bit 9).AeInterrupt Enable FlagDnInvalidate one page in the TLB on the <strong>current CPU</strong> for the \xe2\x80\xa6DlReturn the <strong>guard-page base</strong> of the kernel-stack slot for \xe2\x80\xa6DiFlushes the (non-global) TLB entries for the <strong>current </strong>\xe2\x80\xa6AmReasonable default: clear \xe2\x80\xa6lBits: 56..6400lBits: 16..3200BjContext ID (CNXT-ID) feature is supported.jBits: 0..1AmInitial APIC ID (bits 31:24).CeBit 17 \xe2\x80\x94 MCOMMIT: MCOMMIT instruction enable (AMD).BiMONITOR/MWAIT instructions are supported.BlOS has enabled XSAVE/XRSTOR via CR4.OSXSAVE.CbBit 18 \xe2\x80\x94 OSXSAVE: OS uses XSAVE/XRSTOR and XCR0.Df<strong>Next-level table physical address</strong> (bits 12..51, 4 \xe2\x80\xa6CeNext-level table physical address (bits 12..51, 4 \xe2\x80\xa6Da<strong>Next-level table physical address</strong> (bits 12..51).DbPhysical address bits <strong>51:12</strong> (4 KiB-aligned base).DbPhysical address bits <strong>51:21</strong> (2 MiB-aligned base).DbPhysical address bits <strong>51:30</strong> (1 GiB-aligned base).Dm<strong>P</strong> \xe2\x80\x93 Present bit. Must be <code>1</code> for a valid entry.Ch0 = non-present page. 1 = protection violation (page \xe2\x80\xa6A`Present (bit 0).0BdPresent (bit 0): valid entry if set.1Ce<strong>Present</strong> (bit 0): valid entry if set.2AgSign Flag mask (bit 7).iSign FlagAgTrap Flag mask (bit 8).iTrap FlagAgZero Flag mask (bit 6).iZero FlagCjBits 32\xe2\x80\x9347 \xe2\x80\x94 Kernel code segment selector base for \xe2\x80\xa6BiBit 21 \xe2\x80\x94 AIBRSE: Automatic IBRS Enable.BlCPL-qualified debug store area is supported.Bl64-bit DS area for debug store is supported.AhBase family (bits 11:8).CeBit 3 \xe2\x80\x94 GEWBED (AMD K6 only): Global EWBE# Disable.De<strong>Global</strong> (bit 8): TLB entry not flushed on CR3 reload.0CdGlobal (bit 8): TLB entry not flushed on CR3 reload.DnSet the <em>kernel</em> GS base that becomes active after <code>swapgs</code>.BmBit 9 \xe2\x80\x94 OSFXSR: OS supports FXSAVE/FXRSTOR.B`POPCNT instruction is supported.Bl1 = protection-key violation (if CR4.PKE=1).BaProtection Key / OS use (59..62).000Cg<strong>Protection Key / OS use</strong> (bits 59..62).1ClRDRAND instruction (hardware random number generator) is \xe2\x80\xa6CjBit 2 \xe2\x80\x94 SEWBED (AMD K6 only): Speculative EWBE# Disable.CkStreaming SIMD Extensions 4.1 (SSE4.1) instructions are \xe2\x80\xa6CkStreaming SIMD Extensions 4.2 (SSE4.2) instructions are \xe2\x80\xa6Cgx2APIC mode is supported (Extended APIC ID register \xe2\x80\xa6CfAllocate a buffer to hold a copy of the memory map \xe2\x80\xa6CiSpin until the PIT has counted down approximately one \xe2\x80\xa6CoCLFLUSH line size in <strong>8-byte</strong> units (bits 15:8).CnTry CPUID.15H (TSC/CORE crystal + ratio). EAX = denom, EBX \xe2\x80\xa6BbBit 29 \xe2\x80\x94 Not-Write-Through (NW).BaBit 0 \xe2\x80\x94 Protection Enable (PE).AaAccessed (bit 5).000Dm<strong>Accessed</strong> (A, bit 5): set by CPU on first access via this \xe2\x80\xa61lBits: 32..4000AnBit 30 \xe2\x80\x94 Cache Disable (CD).AhCarry Flag mask (bit 0).jCarry FlagAlProcessor type (bits 13:12).CmBit 16 \xe2\x80\x94 FSGSBASE: Enable {R,W}{D,}FSBASE/GSBASE in CPL \xe2\x80\xa6AfID Flag mask (bit 21).AoID Flag: allows toggling CPUID.lBits: 48..5200kBits: 0..1600AmBit 5 \xe2\x80\x94 Numeric Error (NE).AnOS-available low (bits 9..11).000Dl<strong>OS-available low</strong> (bits 9..11): not interpreted by hardware.1CbSet the PDPT base address (must be 4 KiB-aligned).lBits: 32..64AgStepping ID (bits 3:0).AmBit 3 \xe2\x80\x94 Task Switched (TS).AnBit 16 \xe2\x80\x94 Write Protect (WP).AaWritable (bit 1).0BcWritable (bit 1): write permission.1Cd<strong>Writable</strong> (bit 1): write permission.2DnBuild a <strong>non-leaf (page-table) entry</strong> for a user-accessible \xe2\x80\xa6lBits: 56..6400lBits: 16..3200BjContext ID (CNXT-ID) feature is supported.jBits: 0..1AmInitial APIC ID (bits 31:24).CeBit 17 \xe2\x80\x94 MCOMMIT: MCOMMIT instruction enable (AMD).BiMONITOR/MWAIT instructions are supported.BlOS has enabled XSAVE/XRSTOR via CR4.OSXSAVE.CbBit 18 \xe2\x80\x94 OSXSAVE: OS uses XSAVE/XRSTOR and XCR0.Df<strong>Next-level table physical address</strong> (bits 12..51, 4 \xe2\x80\xa6CeNext-level table physical address (bits 12..51, 4 \xe2\x80\xa6Da<strong>Next-level table physical address</strong> (bits 12..51).DbPhysical address bits <strong>51:12</strong> (4 KiB-aligned base).DbPhysical address bits <strong>51:21</strong> (2 MiB-aligned base).DbPhysical address bits <strong>51:30</strong> (1 GiB-aligned base).Dm<strong>P</strong> \xe2\x80\x93 Present bit. Must be <code>1</code> for a valid entry.Ch0 = non-present page. 1 = protection violation (page \xe2\x80\xa6A`Present (bit 0).0BdPresent (bit 0): valid entry if set.1Ce<strong>Present</strong> (bit 0): valid entry if set.2AgSign Flag mask (bit 7).iSign FlagAgTrap Flag mask (bit 8).iTrap FlagBnEnable write-combining (WC) via PAT registers.AgZero Flag mask (bit 6).iZero FlagCkUnified, ergonomic view over x86-64 paging entries (all \xe2\x80\xa60CnCopy kernel upper-half PML4 entries (slots 256..=511) from \xe2\x80\xa6CmWalks the whole tree and frees empty tables (PT/PD/PDPT). \xe2\x80\xa6AiAdjust Flag mask (bit 4).kAdjust FlagAoBit 18 \xe2\x80\x94 Alignment Mask (AM).AnBit 4 \xe2\x80\x94 Extension Type (ET).AlExtended model (bits 19:16).Bg1 = instruction fetch (execute access).AjNested Task mask (bit 14).kNested TaskB`OS-available high (bits 52..58).000Dh<strong>OS-available high</strong> (bits 52..58): not interpreted by \xe2\x80\xa61Dn<strong>Page Size</strong> (bit 7): <strong>must be 1</strong> for 2 MiB leaf.Dn<strong>Page Size</strong> (bit 7): <strong>must be 1</strong> for 1 GiB leaf.Dk<strong>PAT</strong> (Page Attribute Table) selector for 2 MiB mappings \xe2\x80\xa6Dk<strong>PAT</strong> (Page Attribute Table) selector for 1 GiB mappings \xe2\x80\xa6Eh<strong>PAT</strong> (bit 7) \xe2\x80\x94 <strong>PAT selector bit 2</strong> for 4 KiB mappings.CiPCLMULQDQ (Carry-less multiply) instruction is supported.AiParity Flag mask (bit 2).kParity FlagAgBit 31 \xe2\x80\x94 Paging (PG).BdBits 0\xe2\x80\x932 \xe2\x80\x94 Reserved (must be 0).CmBits 5\xe2\x80\x937 \xe2\x80\x94 Reserved (read as zero, must be written as \xe2\x80\xa6CbBits 5\xe2\x80\x9311 \xe2\x80\x94 Reserved (must be 0 when written).AjBits 52\xe2\x80\x9363 \xe2\x80\x94 Reserved.AdBit 16 \xe2\x80\x94 Reserved.AdBit 19 \xe2\x80\x94 Reserved.AjResume Flag mask (bit 16).kResume FlagBoEnables hardware interrupts (<code>sti</code>).BeVirtual Interrupt Flag mask (bit 19).AfVirtual Interrupt FlagAaAccessed (bit 5).000Dm<strong>Accessed</strong> (A, bit 5): set by CPU on first access via this \xe2\x80\xa61lBits: 32..4000AnBit 30 \xe2\x80\x94 Cache Disable (CD).AhCarry Flag mask (bit 0).jCarry FlagAlProcessor type (bits 13:12).CmBit 16 \xe2\x80\x94 FSGSBASE: Enable {R,W}{D,}FSBASE/GSBASE in CPL \xe2\x80\xa6AfID Flag mask (bit 21).AoID Flag: allows toggling CPUID.lBits: 48..5200kBits: 0..1600AmBit 5 \xe2\x80\x94 Numeric Error (NE).AnOS-available low (bits 9..11).000Dl<strong>OS-available low</strong> (bits 9..11): not interpreted by hardware.1CbSet the PDPT base address (must be 4 KiB-aligned).lBits: 32..64AgStepping ID (bits 3:0).AmBit 3 \xe2\x80\x94 Task Switched (TS).AnBit 16 \xe2\x80\x94 Write Protect (WP).AaWritable (bit 1).0BcWritable (bit 1): write permission.1Cd<strong>Writable</strong> (bit 1): write permission.2CiModel-Specific Register: <strong>kernel GS base</strong>.CjEnd of userspace VA range after which Kernel space begins.0CnAllocate a trampoline stack (optionally with a guard page) \xe2\x80\xa6DdCPU-like predicate for loading a <em>data</em> segment against a \xe2\x80\xa6BcBit 1 \xe2\x80\x94 Monitor Coprocessor (MP).AnAlignment Check mask (bit 18).oAlignment CheckkBits: 0..32AmExtended family (bits 27:20).C`Hypervisor present (running under a hypervisor).AdNo-Execute (bit 63).000Cg<strong>No-Execute</strong> (NX, bit 63 / XD on Intel).1CgBit 10 \xe2\x80\x94 OSXMMEXCPT: OS supports unmasked SIMD FP \xe2\x80\xa6DkBits 48\xe2\x80\x9363 \xe2\x80\x94 User code segment selector base for <code>sysret</code>\xe2\x80\xa6AiAdjust Flag mask (bit 4).kAdjust FlagAoBit 18 \xe2\x80\x94 Alignment Mask (AM).AnBit 4 \xe2\x80\x94 Extension Type (ET).AlExtended model (bits 19:16).Bg1 = instruction fetch (execute access).AjNested Task mask (bit 14).kNested TaskB`OS-available high (bits 52..58).000Dh<strong>OS-available high</strong> (bits 52..58): not interpreted by \xe2\x80\xa61Dn<strong>Page Size</strong> (bit 7): <strong>must be 1</strong> for 2 MiB leaf.Dn<strong>Page Size</strong> (bit 7): <strong>must be 1</strong> for 1 GiB leaf.Dk<strong>PAT</strong> (Page Attribute Table) selector for 2 MiB mappings \xe2\x80\xa6Dk<strong>PAT</strong> (Page Attribute Table) selector for 1 GiB mappings \xe2\x80\xa6Eh<strong>PAT</strong> (bit 7) \xe2\x80\x94 <strong>PAT selector bit 2</strong> for 4 KiB mappings.CiPCLMULQDQ (Carry-less multiply) instruction is supported.AiParity Flag mask (bit 2).kParity FlagAgBit 31 \xe2\x80\x94 Paging (PG).BdBits 0\xe2\x80\x932 \xe2\x80\x94 Reserved (must be 0).CmBits 5\xe2\x80\x937 \xe2\x80\x94 Reserved (read as zero, must be written as \xe2\x80\xa6CbBits 5\xe2\x80\x9311 \xe2\x80\x94 Reserved (must be 0 when written).AjBits 52\xe2\x80\x9363 \xe2\x80\x94 Reserved.AdBit 16 \xe2\x80\x94 Reserved.AdBit 19 \xe2\x80\x94 Reserved.AjResume Flag mask (bit 16).kResume FlagA`A mapping error.DaError returned by <code>MapSize::ensure_chain_for</code> when \xe2\x80\xa6BiVirtual and Physical Memory Address TypesCeLogical processors per package (legacy) (bits 23:16).BjConforming code: <code>CPL \xe2\x89\xa4 DPL</code>.AgBrand index (bits 7:0).BcInterrupt Enable Flag mask (bit 9).AeInterrupt Enable FlagAlOverflow Flag mask (bit 11).mOverflow FlagCjBits 32\xe2\x80\x9347 \xe2\x80\x94 Kernel code segment selector base for \xe2\x80\xa6CkBits 0\xe2\x80\x9363 \xe2\x80\x94 64-bit RIP target for <code>syscall</code>.AnAlignment Check mask (bit 18).oAlignment CheckkBits: 0..32AmExtended family (bits 27:20).C`Hypervisor present (running under a hypervisor).AdNo-Execute (bit 63).000Cg<strong>No-Execute</strong> (NX, bit 63 / XD on Intel).1CgBit 10 \xe2\x80\x94 OSXMMEXCPT: OS supports unmasked SIMD FP \xe2\x80\xa6DkBits 48\xe2\x80\x9363 \xe2\x80\x94 User code segment selector base for <code>sysret</code>\xe2\x80\xa6CjInstall a ring-0 page-fault handler (no user-call) and \xe2\x80\xa6EiLoad all <code>PT_LOAD</code> segments at their <strong>physical LMA</strong> derived \xe2\x80\xa6D`Stack segment load in long mode: <code>CPL == RPL == DPL</code>.CjRemaps the boot framebuffer memory into the kernel\xe2\x80\x99s \xe2\x80\xa6CoCLFLUSH line size in <strong>8-byte</strong> units (bits 15:8).AmDirection Flag mask (bit 10).nDirection FlagAiBit 2 \xe2\x80\x94 Emulation (EM).BbBit 29 \xe2\x80\x94 Not-Write-Through (NW).BaBit 0 \xe2\x80\x94 Protection Enable (PE).C`Bits 12\xe2\x80\x9351 \xe2\x80\x94 PML4 physical base &gt;&gt; 12.Ce1 = caused by reserved bit set in a paging structure.Bl1 = shadow stack access (if CET-SS enabled).BgLocal APIC supports TSC-deadline timer.AgBrand index (bits 7:0).BcInterrupt Enable Flag mask (bit 9).AeInterrupt Enable FlagAlOverflow Flag mask (bit 11).mOverflow FlagCjBits 32\xe2\x80\x9347 \xe2\x80\x94 Kernel code segment selector base for \xe2\x80\xa6CkBits 0\xe2\x80\x9363 \xe2\x80\x94 64-bit RIP target for <code>syscall</code>.C`The PDPT (L3) table: 512 entries, 4 KiB aligned.BcSpurious interrupt vector for APIC.CjTry CPUID.16H (processor base frequency in MHz). EAX = \xe2\x80\xa6CiEnable x2APIC and return the Local APIC ID. Panics if \xe2\x80\xa6DkBring up x2APIC on the BSP and record the APIC ID in <code>PerCpu</code>\xe2\x80\xa6AfCache Disable (bit 4).000Di<strong>Page Cache Disable</strong> (PCD, bit 4): disable caching if set.CnCache Disable (bit 4) \xe2\x80\x94 <strong>PAT selector bit 1</strong>.BeVirtual Interrupt Flag mask (bit 19).AfVirtual Interrupt FlagAfWrite-Through (bit 3).000Dk<strong>Page Write-Through</strong> (PWT, bit 3): write-through caching \xe2\x80\xa6CnWrite-Through (bit 3) \xe2\x80\x94 <strong>PAT selector bit 0</strong>.CoCLFLUSH line size in <strong>8-byte</strong> units (bits 15:8).AmDirection Flag mask (bit 10).nDirection FlagAiBit 2 \xe2\x80\x94 Emulation (EM).BbBit 29 \xe2\x80\x94 Not-Write-Through (NW).BaBit 0 \xe2\x80\x94 Protection Enable (PE).C`Bits 12\xe2\x80\x9351 \xe2\x80\x94 PML4 physical base &gt;&gt; 12.Ce1 = caused by reserved bit set in a paging structure.Bl1 = shadow stack access (if CET-SS enabled).BgLocal APIC supports TSC-deadline timer.A`A mapping error.DaKernel entry running on the boot stack (<code>BOOT_STACK</code>).BmNon-conforming code: <code>CPL == DPL</code>.BcBit 1 \xe2\x80\x94 Monitor Coprocessor (MP).Bl1 = protection-key violation (if CR4.PKE=1).BaProtection Key / OS use (59..62).000Cg<strong>Protection Key / OS use</strong> (bits 59..62).1AfCache Disable (bit 4).000Di<strong>Page Cache Disable</strong> (PCD, bit 4): disable caching if set.CnCache Disable (bit 4) \xe2\x80\x94 <strong>PAT selector bit 1</strong>.DcAlias for <code>user_table_wb_exec</code>: non-leaf, WB-cached, \xe2\x80\xa6BeVirtual Interrupt Flag mask (bit 19).AfVirtual Interrupt FlagAfWrite-Through (bit 3).000Dk<strong>Page Write-Through</strong> (PWT, bit 3): write-through caching \xe2\x80\xa6CnWrite-Through (bit 3) \xe2\x80\x94 <strong>PAT selector bit 0</strong>.CmAddress arithmetic overflow while mapping trampoline code \xe2\x80\xa6AmInitial APIC ID (bits 31:24).CeLogical processors per package (legacy) (bits 23:16).Df<strong>Next-level table physical address</strong> (bits 12..51, 4 \xe2\x80\xa6CeNext-level table physical address (bits 12..51, 4 \xe2\x80\xa6Da<strong>Next-level table physical address</strong> (bits 12..51).DbPhysical address bits <strong>51:12</strong> (4 KiB-aligned base).DbPhysical address bits <strong>51:21</strong> (2 MiB-aligned base).DbPhysical address bits <strong>51:30</strong> (1 GiB-aligned base).BcBit 1 \xe2\x80\x94 Monitor Coprocessor (MP).Bl1 = protection-key violation (if CR4.PKE=1).BaProtection Key / OS use (59..62).000Cg<strong>Protection Key / OS use</strong> (bits 59..62).1CnAddress arithmetic overflow while mapping trampoline stack \xe2\x80\xa6CjInstall a ring-0 page-fault handler (no user-call) and \xe2\x80\xa6AnBit 30 \xe2\x80\x94 Cache Disable (CD).AmBit 5 \xe2\x80\x94 Numeric Error (NE).AnOS-available low (bits 9..11).000Dl<strong>OS-available low</strong> (bits 9..11): not interpreted by hardware.1AmBit 3 \xe2\x80\x94 Task Switched (TS).AnBit 16 \xe2\x80\x94 Write Protect (WP).AmInitial APIC ID (bits 31:24).CeLogical processors per package (legacy) (bits 23:16).Df<strong>Next-level table physical address</strong> (bits 12..51, 4 \xe2\x80\xa6CeNext-level table physical address (bits 12..51, 4 \xe2\x80\xa6Da<strong>Next-level table physical address</strong> (bits 12..51).DbPhysical address bits <strong>51:12</strong> (4 KiB-aligned base).DbPhysical address bits <strong>51:21</strong> (2 MiB-aligned base).DbPhysical address bits <strong>51:30</strong> (1 GiB-aligned base).CbProgram the LAPIC timer in periodic mode (x2APIC).AoBit 18 \xe2\x80\x94 Alignment Mask (AM).AnBit 4 \xe2\x80\x94 Extension Type (ET).Bg1 = instruction fetch (execute access).B`OS-available high (bits 52..58).000Dh<strong>OS-available high</strong> (bits 52..58): not interpreted by \xe2\x80\xa61BhVirtual Interrupt Pending mask (bit 20).AiVirtual Interrupt PendingAnBit 30 \xe2\x80\x94 Cache Disable (CD).AmBit 5 \xe2\x80\x94 Numeric Error (NE).AnOS-available low (bits 9..11).000Dl<strong>OS-available low</strong> (bits 9..11): not interpreted by hardware.1AmBit 3 \xe2\x80\x94 Task Switched (TS).AnBit 16 \xe2\x80\x94 Write Protect (WP).AnAlignment Check mask (bit 18).oAlignment CheckDkBits 48\xe2\x80\x9363 \xe2\x80\x94 User code segment selector base for <code>sysret</code>\xe2\x80\xa6?>=<<<<;<BcInterrupt Enable Flag mask (bit 9).AeInterrupt Enable FlagCjBits 32\xe2\x80\x9347 \xe2\x80\x94 Kernel code segment selector base for \xe2\x80\xa6543CoCLFLUSH line size in <strong>8-byte</strong> units (bits 15:8).BbBit 29 \xe2\x80\x94 Not-Write-Through (NW).BaBit 0 \xe2\x80\x94 Protection Enable (PE).543BeVirtual Interrupt Flag mask (bit 19).AfVirtual Interrupt FlagBhVirtual Interrupt Pending mask (bit 20).AiVirtual Interrupt Pending654BcBit 1 \xe2\x80\x94 Monitor Coprocessor (MP).4321CeLogical processors per package (legacy) (bits 23:16).CkNaked jump pad: set RSP and jump; no Rust frame, no locals.214343")